{
  "hash": "551e47731dfb6b32e907bd51bd719ff0",
  "result": {
    "markdown": "---\ntitle: \"Importation des données\"\ntitle-block-banner: false\ndescription: | \n  Petite description de cette page.\n# à changer\ndate: \"2022-12-21\"\n# Modifier les détails que vous voulez\nauthor:\n  - name: \"Amélie Levasseur-Raymond\"\n    # Votre site web perso ou github\n    url: https://amelie-lr.github.io/\n    # les champs d'affiliation sont optionnels, vous pouvez les\n    # comment out en ajoutant un # devant.\n    affiliation: FAS1002\n    affiliation-url: https://FAS1002.github.io/A22\n    # changer pour votre propre orcid id\n    # https://orcid.org/ pour vous inscrire.\n    # orcid: 0000-0000-0000-0000\n\n# TRUE == Générer une citation pour cette page précise. Pour enlever, mettre false.\ncitation: true\n# Inclure les références que vous utilisez dans vos rapports. Je conseille Zotero pour construire\n# ce fichier ou de connecter RStudio directement pour pouvoir citer avec @nom-de-reference.\nbibliography: references.bib\n---\n\n\n\n::: callout-important\nN'oubliez pas d'inclure vos références sur chacune des pages!\n:::\n\n\n\n::: {.cell}\n\n:::\n\n\n## Téléchargement des données\n\n### Our World in Data - Energy\n\n> Les données proviennent de @owidenergy.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# chemin relatif vers le dossier qui contient les données brutes\nbase_path <- path(\"data\", \"raw\")\n\nurl_energy <- \"https://nyc3.digitaloceanspaces.com/owid-public/data/energy/owid-energy-data.csv\"\n\n# personnaliser le nom du fichier téléchargé en y ajoutant la date du jour\nfname_energy <- paste(today(), \"owid-energy-data.csv\", sep = \"_\")\n# établir le chemin relatif complet de notre fichier personnalisé téléchargé\nfpath_energy <- path(base_path, fname_energy)\n\n# télécharger les données seulement si elles n'ont pas déjà été téléchargées aujourd'hui\n# inspiré de : https://stackoverflow.com/questions/14904983/how-do-i-check-the-existence-of-a-downloaded-file\n# télécharge seulement si le fichier en date du jour n'existe pas en supprimant l'ancienne version\nif (!file.exists(fpath_energy)) {\n    file.remove(paste(base_path, dir(path = base_path, pattern = \"*_owid-energy-data.csv\"), sep = \"/\"))\n    download.file(url = url_energy, \n              destfile = fpath_energy)\n}\n```\n:::\n\n\nLe fichier a été téléchargé ici : **data/raw/2022-12-18_owid-energy-data.csv**\n\n### Gapminder - Life Expectancy at Birth\n\n> Les données proviennent de @gmlifeexpectancy\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# url prise de Download lastest version : Excel file\nurl_life <- \"https://docs.google.com/spreadsheets/d/1RheSon1-q4vFc3AGyupVPH6ptEByE-VtnjOCselU0PE/export?format=xlsx\"\n\n# pour ne pas avoir de demande d'authentification Google\ngs4_deauth()\n\n# date sans le jour (année-mois)\ntoday_month <- paste(year(today()), month(today()), sep = \"-\")\n# personnaliser le nom du fichier téléchargé en y ajoutant la date du jour\nfname_life <- paste(today_month, \"gm-life-expectancy-data.xlsx\", sep = \"_\")\n# établir le chemin relatif complet de notre fichier personnalisé téléchargé\nfpath_life <- path(base_path, fname_life)\n\nif (!file.exists(fpath_life)) {\n    file.remove(paste(base_path, dir(path = base_path, pattern = \"*_gm-life-expectancy-data.xlsx\"), sep = \"/\"))\n    download.file(url = url_life, \n              destfile = fpath_life)\n}\n```\n:::\n\n\nLe fichier a été téléchargé ici : **data/raw/2022-12_gm-life-expectancy-data.xlsx**\n\nNous constatons maintenant que notre dossier contient les fichiers suivants :  \ndata/raw/2022-12-18_owid-energy-data.csv, data/raw/2022-12_gm-life-expectancy-data.xlsx\n\n## Premier coup d'oeil\n\nVoyons d'abord plus en détails ce que nous avons comme données.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy <- as_tibble(read_csv(file = fpath_energy))\n\ndata_life <- as_tibble(read_excel(fpath_life, sheet = \"data-for-countries-etc-by-year\", range = NULL, trim_ws = TRUE, col_names = TRUE))\n```\n:::\n\n\n### Énergie\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(slice_sample(data_energy, n = 10))\n```\n\n::: {.cell-output-display}\n|country                 | year|iso_code | population|          gdp| biofuel_cons_change_pct| biofuel_cons_change_twh| biofuel_cons_per_capita| biofuel_consumption| biofuel_elec_per_capita| biofuel_electricity| biofuel_share_elec| biofuel_share_energy| carbon_intensity_elec| coal_cons_change_pct| coal_cons_change_twh| coal_cons_per_capita| coal_consumption| coal_elec_per_capita| coal_electricity| coal_prod_change_pct| coal_prod_change_twh| coal_prod_per_capita| coal_production| coal_share_elec| coal_share_energy| electricity_demand| electricity_generation| electricity_share_energy| energy_cons_change_pct| energy_cons_change_twh| energy_per_capita| energy_per_gdp| fossil_cons_change_pct| fossil_cons_change_twh| fossil_elec_per_capita| fossil_electricity| fossil_energy_per_capita| fossil_fuel_consumption| fossil_share_elec| fossil_share_energy| gas_cons_change_pct| gas_cons_change_twh| gas_consumption| gas_elec_per_capita| gas_electricity| gas_energy_per_capita| gas_prod_change_pct| gas_prod_change_twh| gas_prod_per_capita| gas_production| gas_share_elec| gas_share_energy| greenhouse_gas_emissions| hydro_cons_change_pct| hydro_cons_change_twh| hydro_consumption| hydro_elec_per_capita| hydro_electricity| hydro_energy_per_capita| hydro_share_elec| hydro_share_energy| low_carbon_cons_change_pct| low_carbon_cons_change_twh| low_carbon_consumption| low_carbon_elec_per_capita| low_carbon_electricity| low_carbon_energy_per_capita| low_carbon_share_elec| low_carbon_share_energy| net_elec_imports| net_elec_imports_share_demand| nuclear_cons_change_pct| nuclear_cons_change_twh| nuclear_consumption| nuclear_elec_per_capita| nuclear_electricity| nuclear_energy_per_capita| nuclear_share_elec| nuclear_share_energy| oil_cons_change_pct| oil_cons_change_twh| oil_consumption| oil_elec_per_capita| oil_electricity| oil_energy_per_capita| oil_prod_change_pct| oil_prod_change_twh| oil_prod_per_capita| oil_production| oil_share_elec| oil_share_energy| other_renewable_consumption| other_renewable_electricity| other_renewable_exc_biofuel_electricity| other_renewables_cons_change_pct| other_renewables_cons_change_twh| other_renewables_elec_per_capita| other_renewables_elec_per_capita_exc_biofuel| other_renewables_energy_per_capita| other_renewables_share_elec| other_renewables_share_elec_exc_biofuel| other_renewables_share_energy| per_capita_electricity| primary_energy_consumption| renewables_cons_change_pct| renewables_cons_change_twh| renewables_consumption| renewables_elec_per_capita| renewables_electricity| renewables_energy_per_capita| renewables_share_elec| renewables_share_energy| solar_cons_change_pct| solar_cons_change_twh| solar_consumption| solar_elec_per_capita| solar_electricity| solar_energy_per_capita| solar_share_elec| solar_share_energy| wind_cons_change_pct| wind_cons_change_twh| wind_consumption| wind_elec_per_capita| wind_electricity| wind_energy_per_capita| wind_share_elec| wind_share_energy|\n|:-----------------------|----:|:--------|----------:|------------:|-----------------------:|-----------------------:|-----------------------:|-------------------:|-----------------------:|-------------------:|------------------:|--------------------:|---------------------:|--------------------:|--------------------:|--------------------:|----------------:|--------------------:|----------------:|--------------------:|--------------------:|--------------------:|---------------:|---------------:|-----------------:|------------------:|----------------------:|------------------------:|----------------------:|----------------------:|-----------------:|--------------:|----------------------:|----------------------:|----------------------:|------------------:|------------------------:|-----------------------:|-----------------:|-------------------:|-------------------:|-------------------:|---------------:|-------------------:|---------------:|---------------------:|-------------------:|-------------------:|-------------------:|--------------:|--------------:|----------------:|------------------------:|---------------------:|---------------------:|-----------------:|---------------------:|-----------------:|-----------------------:|----------------:|------------------:|--------------------------:|--------------------------:|----------------------:|--------------------------:|----------------------:|----------------------------:|---------------------:|-----------------------:|----------------:|-----------------------------:|-----------------------:|-----------------------:|-------------------:|-----------------------:|-------------------:|-------------------------:|------------------:|--------------------:|-------------------:|-------------------:|---------------:|-------------------:|---------------:|---------------------:|-------------------:|-------------------:|-------------------:|--------------:|--------------:|----------------:|---------------------------:|---------------------------:|---------------------------------------:|--------------------------------:|--------------------------------:|--------------------------------:|--------------------------------------------:|----------------------------------:|---------------------------:|---------------------------------------:|-----------------------------:|----------------------:|--------------------------:|--------------------------:|--------------------------:|----------------------:|--------------------------:|----------------------:|----------------------------:|---------------------:|-----------------------:|---------------------:|---------------------:|-----------------:|---------------------:|-----------------:|-----------------------:|----------------:|------------------:|--------------------:|--------------------:|----------------:|--------------------:|----------------:|----------------------:|---------------:|-----------------:|\n|Netherlands Antilles    | 1981|ANT      |         NA|           NA|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|                   NA|                0.000|                   NA|           0.000|              NA|                NA|                 NA|                     NA|                       NA|                 -8.508|                 -5.949|                NA|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|               0.000|                  NA|          0.000|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|               0.000|                  NA|          0.000|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                     63.980|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|Ireland                 | 1920|IRL      |    4200881|           NA|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|               17.021|                0.130|              213.172|           0.896|              NA|                NA|                 NA|                     NA|                       NA|                     NA|                     NA|                NA|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|               0.000|               0.000|          0.000|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|                  NA|                  NA|             NA|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                         NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|Other Asia Pacific (BP) | 2011|NA       |         NA|           NA|                  15.221|                   0.864|                      NA|                6.54|                      NA|                  NA|                 NA|                1.211|                    NA|              -16.595|              -31.072|                   NA|          156.164|                   NA|           70.251|                7.455|               17.998|                   NA|         259.438|          91.234|            28.911|                 NA|                 77.000|                   14.255|                 -0.557|                 -3.024|                NA|             NA|                 -4.461|                -19.094|                     NA|            289.393|                       NA|                 408.969|           375.833|              75.714|               6.639|               4.310|          69.226|                  NA|         151.247|                    NA|              -0.732|              -1.308|                  NA|        177.260|        196.423|           12.816|                       NA|                14.720|                15.962|           129.810|                    NA|            47.056|                      NA|           61.111|             24.032|                     14.728|                     16.934|                137.722|                         NA|                 47.500|                           NA|                61.688|                  25.497|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|               4.359|               7.668|         183.579|                  NA|          67.896|                    NA|              -5.248|              -8.516|                  NA|        153.775|         88.176|           33.987|                       1.072|                       0.336|                                      NA|                            8.430|                            0.083|                               NA|                                           NA|                                 NA|                       0.436|                                      NA|                         0.198|                     NA|                    540.151|                     14.728|                     16.934|                137.722|                         NA|                 47.500|                           NA|                61.688|                  25.497|                57.222|                 0.050|             0.138|                    NA|             0.050|                      NA|            0.065|              0.026|              -13.195|               -0.026|            0.162|                   NA|            0.059|                     NA|           0.076|             0.030|\n|G7 (Ember)              | 2003|NA       |         NA|           NA|                      NA|                      NA|                      NA|                  NA|                      NA|               99.23|              1.367|                   NA|               455.870|                   NA|                   NA|                   NA|               NA|                   NA|         2831.250|                   NA|                   NA|                   NA|              NA|          38.999|                NA|            7259.73|               7259.730|                       NA|                     NA|                     NA|                NA|             NA|                     NA|                     NA|                     NA|           4530.000|                       NA|                      NA|            62.399|                  NA|                  NA|                  NA|              NA|                  NA|        1266.900|                    NA|                  NA|                  NA|                  NA|             NA|         17.451|               NA|                  3309.49|                    NA|                    NA|                NA|                    NA|           812.160|                      NA|           11.187|                 NA|                         NA|                         NA|                     NA|                         NA|               2729.730|                           NA|                37.601|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|            1757.710|                        NA|             24.212|                   NA|                  NA|                  NA|              NA|                  NA|         431.850|                    NA|                  NA|                  NA|                  NA|             NA|          5.949|               NA|                          NA|                     122.990|                                   23.76|                               NA|                               NA|                               NA|                                           NA|                                 NA|                       1.694|                                   0.327|                            NA|                     NA|                         NA|                         NA|                         NA|                     NA|                         NA|                972.020|                           NA|                13.389|                      NA|                    NA|                    NA|                NA|                    NA|             1.790|                      NA|            0.025|                 NA|                   NA|                   NA|               NA|                   NA|           35.080|                     NA|           0.483|                NA|\n|North America (Shift)   | 1901|NA       |         NA|           NA|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|                8.872|              166.369|                   NA|        2041.500|              NA|                NA|                 NA|                     NA|                       NA|                     NA|                     NA|                NA|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|              10.817|               7.988|                  NA|         81.828|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|               8.729|               8.734|                  NA|        108.799|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                         NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|Belgium                 | 1924|BEL      |    7746881|  56977850368|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|                1.915|                3.270|            22463.736|         174.024|              NA|                NA|                 NA|                     NA|                       NA|                     NA|                     NA|                NA|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|               0.000|               0.000|          0.000|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|                  NA|                  NA|             NA|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                         NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|Spain                   | 1972|ESP      |   34515176| 372604076032|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                2.413|                2.768|             3403.564|          117.475|                   NA|               NA|                2.592|                2.420|             2775.958|          95.813|              NA|            18.660|                 NA|                     NA|                       NA|                  8.135|                 47.362|          18240.16|          1.690|                  6.283|                 30.209|                     NA|                 NA|                 14805.23|                 511.005|                NA|              81.168|             194.416|               7.737|          11.716|                  NA|              NA|               339.445|             -92.308|              -0.289|               0.697|          0.024|             NA|            1.861|                       NA|                11.482|                10.802|           104.881|              1027.635|            35.469|                3038.705|               NA|             16.659|                     17.127|                     17.153|                118.557|                   1167.052|                 40.281|                     3434.930|                    NA|                  18.832|               NA|                            NA|                  88.308|                   6.322|              13.481|                  137.65|               4.751|                   390.583|                 NA|                2.141|               5.442|              19.705|         381.815|                  NA|              NA|              11062.23|              12.195|               0.174|              46.500|          1.605|             NA|           60.648|                       0.195|                       0.061|                                      NA|                           17.308|                            0.029|                            1.767|                                           NA|                              5.642|                          NA|                                      NA|                         0.031|                     NA|                    629.562|                     11.491|                     10.831|                105.076|                   1029.402|                 35.530|                     3044.347|                    NA|                  16.690|                    NA|                 0.000|             0.000|                 0.000|             0.000|                   0.000|               NA|              0.000|                   NA|                0.000|            0.000|                0.000|            0.000|                  0.000|              NA|             0.000|\n|Algeria                 | 1927|DZA      |    6189659|           NA|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|               50.000|                0.057|               27.620|           0.171|              NA|                NA|                 NA|                     NA|                       NA|                     NA|                     NA|                NA|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|               0.000|               0.000|          0.000|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|               0.000|               0.000|               1.879|          0.012|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                         NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|Australia               | 1998|AUS      |   18601666| 634305052672|                      NA|                   0.000|                       0|                0.00|                      NA|                  NA|                 NA|                0.000|                    NA|                4.462|               23.625|            29732.998|          553.083|             8921.023|          165.946|                2.403|               42.988|            98491.273|        1832.102|          83.193|            44.377|                 NA|                199.471|                   16.005|                  2.386|                 29.042|          67001.02|          1.965|                  2.501|                 29.186|               9794.197|            182.188|                 64295.68|                1196.007|            91.336|              95.962|               2.952|               5.648|         196.953|             777.753|          14.467|             10587.934|               2.146|               6.361|           16274.729|        302.737|          7.253|           15.803|                       NA|                -0.968|                -0.457|            46.715|               849.279|            15.798|                2511.308|            7.920|              3.748|                     -0.324|                     -0.143|                 50.324|                    910.273|                 16.933|                     2705.337|                 8.489|                   4.038|               NA|                            NA|                      NA|                   0.000|               0.000|                    0.00|               0.000|                     0.000|              0.000|                0.000|              -0.020|              -0.088|         445.970|              95.422|           1.775|              23974.75|              -5.314|             -18.410|           17634.201|        328.026|          0.890|           35.783|                       3.451|                       1.081|                                      NA|                            8.425|                            0.268|                           58.113|                                           NA|                            185.509|                       0.542|                                      NA|                         0.277|              10723.286|                   1246.331|                     -0.324|                     -0.143|                 50.324|                    910.273|                 16.933|                     2705.337|                 8.489|                   4.038|                16.150|                 0.015|             0.105|                 1.914|             0.036|                   5.659|            0.018|              0.008|              140.000|                0.031|            0.053|                0.968|            0.018|                  2.861|           0.009|             0.004|\n|Angola                  | 2004|AGO      |   18771128|  41307009024|                      NA|                      NA|                      NA|                  NA|                       0|                0.00|              0.000|                   NA|               165.138|                   NA|                   NA|                   NA|               NA|                0.000|            0.000|                   NA|                0.000|                0.000|           0.000|           0.000|                NA|               2.18|                  2.180|                       NA|                 10.586|                  4.411|           2454.67|          1.115|                     NA|                     NA|                 23.973|              0.450|                       NA|                      NA|            20.642|                  NA|                  NA|                  NA|              NA|               0.000|           0.000|                    NA|              15.385|               1.085|             433.346|          8.134|          0.000|               NA|                     0.36|                    NA|                    NA|                NA|                92.163|             1.730|                      NA|           79.358|                 NA|                         NA|                         NA|                     NA|                     92.163|                  1.730|                           NA|                79.358|                      NA|                0|                             0|                      NA|                      NA|                  NA|                    0.00|               0.000|                        NA|              0.000|                   NA|                  NA|                  NA|              NA|              23.973|           0.450|                    NA|              27.433|             136.655|           33817.891|        634.800|         20.642|               NA|                          NA|                       0.000|                                    0.00|                               NA|                               NA|                            0.000|                                            0|                                 NA|                       0.000|                                   0.000|                            NA|                116.136|                     46.077|                         NA|                         NA|                     NA|                     92.163|                  1.730|                           NA|                79.358|                      NA|                    NA|                    NA|                NA|                 0.000|             0.000|                      NA|            0.000|                 NA|                   NA|                   NA|               NA|                0.000|            0.000|                     NA|           0.000|                NA|\n:::\n:::\n\n\nPremière question à se poser : Utiliserons-nous toutes ces variables?  \nSûrement pas, d'autant plus qu'il semble y avoir beaucoup d'informations manquantes. Nous y reviendrons...\n\n### Espérance de vie\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(slice_sample(data_life, n = 10))\n```\n\n::: {.cell-output-display}\n|geo |name     | time| Life expectancy|\n|:---|:--------|----:|---------------:|\n|jor |Jordan   | 1876|           32.34|\n|mlt |Malta    | 2057|           87.36|\n|zmb |Zambia   | 1896|           34.08|\n|kir |Kiribati | 1822|           24.90|\n|alb |Albania  | 1945|           45.39|\n|irl |Ireland  | 1852|           38.30|\n|ago |Angola   | 1970|           46.57|\n|arm |Armenia  | 1986|           71.66|\n|ner |Niger    | 1904|           31.89|\n|bhr |Bahrain  | 2039|           79.54|\n:::\n:::\n\n\n\n\n## Nettoyage des données\n\nÀ première vue, les données semblent être bien arrangées et *tidy*. Rien de trop grave ne saute aux yeux. Uniformisons cependant les noms des colonnes entre les deux jeux de données en les nettoyant un peu par le fait même.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# renommer les titres de colonnes de data_life pour concorder avec ceux de data_energy\ndata_life_clean <- data_life %>%\n    dplyr::rename(life_expectancy = `Life expectancy`,\n                  year = `time`,\n                  country = `name`,\n                  iso_code = `geo`)\n```\n:::\n\n\nLes codes ISO des pays devraient aussi être uniformisés pour les avoir en majuscules dans les deux jeux.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# convertir les codes ISO du jeux data_life pour qu'ils soient en majuscules\n# inspiré de : https://stackoverflow.com/questions/16516593/convert-from-lowercase-to-uppercase-all-values-in-all-character-variables-in-dat\ndata_life_clean$iso_code <- toupper(data_life_clean$iso_code)\n```\n:::\n\n\n\n\n## Manipulations\n\nNous ne conserverons que les variables qui nous intéressent du jeux Energy. Nous nous attarderons donc seulement à l'énergie **consommée**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy_cons <- data_energy %>%\n    select(iso_code,\n           country,\n           year,\n           population,\n           contains(\"cons\")\n           )\n\nkable(slice_sample(data_energy_cons, n = 10))\n```\n\n::: {.cell-output-display}\n|iso_code |country                       | year| population| biofuel_cons_change_pct| biofuel_cons_change_twh| biofuel_cons_per_capita| biofuel_consumption| coal_cons_change_pct| coal_cons_change_twh| coal_cons_per_capita| coal_consumption| energy_cons_change_pct| energy_cons_change_twh| fossil_cons_change_pct| fossil_cons_change_twh| fossil_fuel_consumption| gas_cons_change_pct| gas_cons_change_twh| gas_consumption| hydro_cons_change_pct| hydro_cons_change_twh| hydro_consumption| low_carbon_cons_change_pct| low_carbon_cons_change_twh| low_carbon_consumption| nuclear_cons_change_pct| nuclear_cons_change_twh| nuclear_consumption| oil_cons_change_pct| oil_cons_change_twh| oil_consumption| other_renewable_consumption| other_renewables_cons_change_pct| other_renewables_cons_change_twh| primary_energy_consumption| renewables_cons_change_pct| renewables_cons_change_twh| renewables_consumption| solar_cons_change_pct| solar_cons_change_twh| solar_consumption| wind_cons_change_pct| wind_cons_change_twh| wind_consumption|\n|:--------|:-----------------------------|----:|----------:|-----------------------:|-----------------------:|-----------------------:|-------------------:|--------------------:|--------------------:|--------------------:|----------------:|----------------------:|----------------------:|----------------------:|----------------------:|-----------------------:|-------------------:|-------------------:|---------------:|---------------------:|---------------------:|-----------------:|--------------------------:|--------------------------:|----------------------:|-----------------------:|-----------------------:|-------------------:|-------------------:|-------------------:|---------------:|---------------------------:|--------------------------------:|--------------------------------:|--------------------------:|--------------------------:|--------------------------:|----------------------:|---------------------:|---------------------:|-----------------:|--------------------:|--------------------:|----------------:|\n|CAF      |Central African Republic      | 2017|    4996741|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                  0.018|                  0.000|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                      1.507|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|NA       |Oceania                       | 1968|   18657991|                      NA|                      NA|                      NA|                  NA|                2.344|                5.444|            12739.082|          237.686|                  5.445|                 30.735|                  5.480|                 27.651|                 532.271|             675.000|               0.265|           0.305|                 4.765|                 2.653|            58.323|                      5.186|                      3.084|                 62.898|                      NA|                       0|                   0|               8.057|              21.941|         294.281|                       4.575|                           10.744|                            0.431|                    595.169|                      5.186|                      3.084|                 62.898|                    NA|                 0.000|             0.000|                   NA|                   NA|               NA|\n|NA       |World                         | 1960| 3019233536|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                     NA|                     NA|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                         NA|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|NA       |Lower-middle-income countries | 1914|  584339849|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                     NA|                     NA|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                         NA|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|MYS      |Malaysia                      | 1981|   13564596|                      NA|                      NA|                      NA|                  NA|               86.000|                0.500|               79.736|            1.082|                  3.380|                  4.280|                  3.127|                  3.829|                 126.274|             -15.914|              -4.140|          21.876|                10.833|                 0.451|             4.617|                     10.833|                      0.451|                  4.617|                      NA|                       0|                   0|               7.792|               7.469|         103.317|                       0.000|                               NA|                            0.000|                    130.891|                     10.833|                      0.451|                  4.617|                    NA|                 0.000|             0.000|                   NA|                    0|            0.000|\n|MDG      |Madagascar                    | 1935|    3174789|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                     NA|                     NA|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                         NA|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|BGD      |Bangladesh                    | 2020|  167420944|                      NA|                      NA|                      NA|                  NA|               12.957|                4.994|              260.059|           43.539|                 -3.045|                -13.779|                 -3.028|                -13.611|                 435.919|              -3.294|             -10.191|         299.153|               -14.873|                -0.329|             1.840|                     -5.151|                     -0.168|                  2.888|                      NA|                       0|                   0|              -8.279|              -8.415|          93.226|                       0.010|                            6.231|                            0.001|                    438.806|                     -5.151|                     -0.168|                  2.888|                19.095|                 0.161|             1.024|                0.274|                    0|            0.013|\n|NA       |Serbia and Montenegro         | 2003|    8519822|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                  0.962|                  2.605|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                    273.289|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|TWN      |Taiwan                        | 1924|    3894299|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                     NA|                     NA|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                         NA|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|ATA      |Antarctica                    | 1998|         NA|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                  0.000|                  0.000|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                      0.935|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n:::\n:::\n\n\nDéjà beaucoup mieux, nous sommes passé de 129 à 45 variables. \nMais il y encore encore beaucoup de bruit, réduisons encore un peu plus.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy_cons <- data_energy_cons %>%\n    select(iso_code,\n           country,\n           year,\n           population,\n           contains(\"consumption\")\n           )\n\nkable(slice_sample(data_energy_cons, n = 10))\n```\n\n::: {.cell-output-display}\n|iso_code |country              | year| population| biofuel_consumption| coal_consumption| fossil_fuel_consumption| gas_consumption| hydro_consumption| low_carbon_consumption| nuclear_consumption| oil_consumption| other_renewable_consumption| primary_energy_consumption| renewables_consumption| solar_consumption| wind_consumption|\n|:--------|:--------------------|----:|----------:|-------------------:|----------------:|-----------------------:|---------------:|-----------------:|----------------------:|-------------------:|---------------:|---------------------------:|--------------------------:|----------------------:|-----------------:|----------------:|\n|GEO      |Georgia              | 2009|    3855203|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                     52.634|                     NA|                NA|               NA|\n|NA       |Total Non-OPEC (BP)  | 1997|         NA|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|MNG      |Mongolia             | 1976|    1529093|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|PRK      |North Korea          | 1972|   15768368|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|ESH      |Western Sahara       | 2002|     297420|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                      1.069|                     NA|                NA|               NA|\n|SVN      |Slovenia             | 2000|    1984339|                  NA|           15.788|                  53.556|           9.598|            11.337|                  25.07|              13.509|          28.171|                       0.223|                     78.626|                 11.561|                 0|                0|\n|ARE      |United Arab Emirates | 1950|      74613|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|NA       |Asia & Oceania (EIA) | 1981|         NA|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                  15160.885|                     NA|                NA|               NA|\n|ESP      |Spain                | 1934|   24346846|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|GIB      |Gibraltar            | 2013|      32437|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n:::\n:::\n\n\n\n### Ajout d'une variable *continents*\n\n> Pour ce faire, nous utiliserons le package de @countrycodepack\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy_cons_clean <- data_energy_cons %>%\n    mutate(countrycode(data_energy_cons$iso_code, origin = \"iso3c\", destination = \"continent\", custom_match = c( ATA = 'Antartica', ANT = 'Americas')), .before = 1) %>%\n    rename(continent = `countrycode(...)`)\n\nkable(slice_sample(data_energy_cons_clean, n = 10))\n```\n\n::: {.cell-output-display}\n|continent |iso_code |country                    | year| population| biofuel_consumption| coal_consumption| fossil_fuel_consumption| gas_consumption| hydro_consumption| low_carbon_consumption| nuclear_consumption| oil_consumption| other_renewable_consumption| primary_energy_consumption| renewables_consumption| solar_consumption| wind_consumption|\n|:---------|:--------|:--------------------------|----:|----------:|-------------------:|----------------:|-----------------------:|---------------:|-----------------:|----------------------:|-------------------:|---------------:|---------------------------:|--------------------------:|----------------------:|-----------------:|----------------:|\n|Americas  |VGB      |British Virgin Islands     | 1988|      14620|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                      0.194|                     NA|                NA|               NA|\n|NA        |NA       |Middle Africa (BP)         | 2019|         NA|                  NA|            1.687|                 200.203|          50.589|            79.395|                 79.771|                  NA|         147.927|                       0.168|                    279.974|                 79.771|             0.184|            0.023|\n|NA        |NA       |OECD - North America (EIA) | 2004|         NA|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                  35299.762|                     NA|                NA|               NA|\n|NA        |NA       |Non-OECD (EIA)             | 1991|         NA|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                  44013.086|                     NA|                NA|               NA|\n|Europe    |BLR      |Belarus                    | 1987|   10270610|                  NA|           26.711|                 472.560|          99.543|             0.059|                  0.059|               0.000|         346.306|                          NA|                    472.619|                  0.059|                NA|               NA|\n|NA        |NA       |Other CIS (BP)             | 1995|         NA|                  NA|           10.686|                  88.359|          50.974|            82.680|                 83.543|               0.863|          26.698|                       0.000|                    171.902|                 82.680|             0.000|            0.000|\n|NA        |NA       |European Union (27)        | 1908|  276515264|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|Americas  |SUR      |Suriname                   | 1958|     250574|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|Americas  |GTM      |Guatemala                  | 1933|    1979286|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|Africa    |LBY      |Libya                      | 1961|    1478764|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n:::\n:::\n\n\nUn message nous mentionne que deux codes ISO de pays n'ont pas trouvé d'équivalent, nous avons donc dû les ajouter au code manuellement.\n\nAprès une analyse un peu plus poussée du jeu de données, nous constatons que la variable *country* correspond parfois à un pays et d'autres, à un continent ou région. Il serait donc préférable d'éliminer ces observations du jeu maintenant que nous avons ajouté la variable *continent*. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy_cons_clean <- data_energy_cons_clean %>%\n    filter(!is.na(continent))\n```\n:::\n\n\nLes pays sont donc maintenant associés aux continents suivants dans notre jeu de données :  \nAsia, Europe, Africa, Oceania, Antartica, Americas\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# html <- \"\"\n# \n# data_continents <- read_html(x = html) %>%\n#     html_element(css = \".data-table\") #%>% \n#     #html_table()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# quelques info utiles sur le fichier\n#file.info(fpath_energy)\n\n# paste avec le file.path quand on ouvre\n```\n:::\n\n\n\n\n\n\n\n## Sauvegarde de nos jeux de données nettoyés\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_csv(data_energy_cons_clean, file = \"data/processed/owid-energy-consumption-data.csv\")\nwrite_csv(data_life_clean, file = \"data/processed/gm-life-expectancy-data.csv\")\n```\n:::\n\n\nNous voilà maintenant avec nos deux jeux de données nettoyés que nous pourrons réutiliser :  \ndata/processed/gm-life-expectancy-data.csv, data/processed/owid-energy-consumption-data.csv\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}