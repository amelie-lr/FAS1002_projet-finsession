{
  "hash": "14d4a8d14246db50f8ca596b1317ae85",
  "result": {
    "markdown": "---\ntitle: \"Importation des données\"\ntitle-block-banner: false\ndescription: | \n  Petite description de cette page.\n# à changer\ndate: \"2022-12-21\"\n# Modifier les détails que vous voulez\nauthor:\n  - name: \"Amélie Levasseur-Raymond\"\n    # Votre site web perso ou github\n    url: https://amelie-lr.github.io/\n    # les champs d'affiliation sont optionnels, vous pouvez les\n    # comment out en ajoutant un # devant.\n    affiliation: FAS1002\n    affiliation-url: https://FAS1002.github.io/A22\n    # changer pour votre propre orcid id\n    # https://orcid.org/ pour vous inscrire.\n    # orcid: 0000-0000-0000-0000\n\n# TRUE == Générer une citation pour cette page précise. Pour enlever, mettre false.\ncitation: true\n# Inclure les références que vous utilisez dans vos rapports. Je conseille Zotero pour construire\n# ce fichier ou de connecter RStudio directement pour pouvoir citer avec @nom-de-reference.\nbibliography: references.bib\n---\n\n\n\n::: callout-important\nN'oubliez pas d'inclure vos références sur chacune des pages!\n:::\n\nPar exemple:\n\n> Les données proviennent entre autres de @owidenergy.\n\n\n::: {.cell}\n\n:::\n\n\n## Téléchargement des données\n\n### Our World in Data - Energy\n\n> Les données proviennent de @owidenergy.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# chemin relatif vers le dossier qui contient les données brutes\nbase_path <- path(\"data\", \"raw\")\n\nurl_energy <- \"https://nyc3.digitaloceanspaces.com/owid-public/data/energy/owid-energy-data.csv\"\n\n# personnaliser le nom du fichier téléchargé en y ajoutant la date du jour\nfname_energy <- paste(today(), \"owid-energy-data.csv\", sep = \"_\")\n# établir le chemin relatif complet de notre fichier personnalisé téléchargé\nfpath_energy <- path(base_path, fname_energy)\n\n# télécharger les données seulement si elles n'ont pas déjà été téléchargées aujourd'hui\n# inspiré de : https://stackoverflow.com/questions/14904983/how-do-i-check-the-existence-of-a-downloaded-file\n# télécharge seulement si le fichier en date du jour n'existe pas en supprimant l'ancienne version\nif (!file.exists(fpath_energy)) {\n    file.remove(paste(base_path, dir(path = base_path, pattern = \"*_owid-energy-data.csv\"), sep = \"/\"))\n    download.file(url = url_energy, \n              destfile = fpath_energy)\n}\n```\n:::\n\n\nLe fichier a été téléchargé ici : **data/raw/2022-12-17_owid-energy-data.csv**\n\n### Gapminder - Life Expectancy at Birth\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# url prise de Download lastest version : Excel file\nurl_life <- \"https://docs.google.com/spreadsheets/d/1RheSon1-q4vFc3AGyupVPH6ptEByE-VtnjOCselU0PE/export?format=xlsx\"\n\n# pour ne pas avoir de demande d'authentification Google\ngs4_deauth()\n\n# date sans le jour (année-mois)\ntoday_month <- paste(year(today()), month(today()), sep = \"-\")\n# personnaliser le nom du fichier téléchargé en y ajoutant la date du jour\nfname_life <- paste(today_month, \"gm-life-expectancy-data.xlsx\", sep = \"_\")\n# établir le chemin relatif complet de notre fichier personnalisé téléchargé\nfpath_life <- path(base_path, fname_life)\n\nif (!file.exists(fpath_life)) {\n    file.remove(paste(base_path, dir(path = base_path, pattern = \"*_gm-life-expectancy-data.xlsx\"), sep = \"/\"))\n    download.file(url = url_life, \n              destfile = fpath_life)\n}\n```\n:::\n\n\nLe fichier a été téléchargé ici : **data/raw/2022-12_gm-life-expectancy-data.xlsx**\n\nNous constatons maintenant que notre dossier contient les fichiers suivants :  \ndata/raw/2022-12-17_owid-energy-data.csv, data/raw/2022-12_gm-life-expectancy-data.xlsx\n\n## Premier coup d'oeil\n\nVoyons d'abord plus en détails ce que nous avons comme données.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy <- as_tibble(read_csv(file = fpath_energy))\n\ndata_life <- as_tibble(read_excel(fpath_life, sheet = \"data-for-countries-etc-by-year\", range = NULL, trim_ws = TRUE, col_names = TRUE))\n```\n:::\n\n\n### Énergie\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(slice_sample(data_energy, n = 10))\n```\n\n::: {.cell-output-display}\n|country        | year|iso_code | population|          gdp| biofuel_cons_change_pct| biofuel_cons_change_twh| biofuel_cons_per_capita| biofuel_consumption| biofuel_elec_per_capita| biofuel_electricity| biofuel_share_elec| biofuel_share_energy| carbon_intensity_elec| coal_cons_change_pct| coal_cons_change_twh| coal_cons_per_capita| coal_consumption| coal_elec_per_capita| coal_electricity| coal_prod_change_pct| coal_prod_change_twh| coal_prod_per_capita| coal_production| coal_share_elec| coal_share_energy| electricity_demand| electricity_generation| electricity_share_energy| energy_cons_change_pct| energy_cons_change_twh| energy_per_capita| energy_per_gdp| fossil_cons_change_pct| fossil_cons_change_twh| fossil_elec_per_capita| fossil_electricity| fossil_energy_per_capita| fossil_fuel_consumption| fossil_share_elec| fossil_share_energy| gas_cons_change_pct| gas_cons_change_twh| gas_consumption| gas_elec_per_capita| gas_electricity| gas_energy_per_capita| gas_prod_change_pct| gas_prod_change_twh| gas_prod_per_capita| gas_production| gas_share_elec| gas_share_energy| greenhouse_gas_emissions| hydro_cons_change_pct| hydro_cons_change_twh| hydro_consumption| hydro_elec_per_capita| hydro_electricity| hydro_energy_per_capita| hydro_share_elec| hydro_share_energy| low_carbon_cons_change_pct| low_carbon_cons_change_twh| low_carbon_consumption| low_carbon_elec_per_capita| low_carbon_electricity| low_carbon_energy_per_capita| low_carbon_share_elec| low_carbon_share_energy| net_elec_imports| net_elec_imports_share_demand| nuclear_cons_change_pct| nuclear_cons_change_twh| nuclear_consumption| nuclear_elec_per_capita| nuclear_electricity| nuclear_energy_per_capita| nuclear_share_elec| nuclear_share_energy| oil_cons_change_pct| oil_cons_change_twh| oil_consumption| oil_elec_per_capita| oil_electricity| oil_energy_per_capita| oil_prod_change_pct| oil_prod_change_twh| oil_prod_per_capita| oil_production| oil_share_elec| oil_share_energy| other_renewable_consumption| other_renewable_electricity| other_renewable_exc_biofuel_electricity| other_renewables_cons_change_pct| other_renewables_cons_change_twh| other_renewables_elec_per_capita| other_renewables_elec_per_capita_exc_biofuel| other_renewables_energy_per_capita| other_renewables_share_elec| other_renewables_share_elec_exc_biofuel| other_renewables_share_energy| per_capita_electricity| primary_energy_consumption| renewables_cons_change_pct| renewables_cons_change_twh| renewables_consumption| renewables_elec_per_capita| renewables_electricity| renewables_energy_per_capita| renewables_share_elec| renewables_share_energy| solar_cons_change_pct| solar_cons_change_twh| solar_consumption| solar_elec_per_capita| solar_electricity| solar_energy_per_capita| solar_share_elec| solar_share_energy| wind_cons_change_pct| wind_cons_change_twh| wind_consumption| wind_elec_per_capita| wind_electricity| wind_energy_per_capita| wind_share_elec| wind_share_energy|\n|:--------------|----:|:--------|----------:|------------:|-----------------------:|-----------------------:|-----------------------:|-------------------:|-----------------------:|-------------------:|------------------:|--------------------:|---------------------:|--------------------:|--------------------:|--------------------:|----------------:|--------------------:|----------------:|--------------------:|--------------------:|--------------------:|---------------:|---------------:|-----------------:|------------------:|----------------------:|------------------------:|----------------------:|----------------------:|-----------------:|--------------:|----------------------:|----------------------:|----------------------:|------------------:|------------------------:|-----------------------:|-----------------:|-------------------:|-------------------:|-------------------:|---------------:|-------------------:|---------------:|---------------------:|-------------------:|-------------------:|-------------------:|--------------:|--------------:|----------------:|------------------------:|---------------------:|---------------------:|-----------------:|---------------------:|-----------------:|-----------------------:|----------------:|------------------:|--------------------------:|--------------------------:|----------------------:|--------------------------:|----------------------:|----------------------------:|---------------------:|-----------------------:|----------------:|-----------------------------:|-----------------------:|-----------------------:|-------------------:|-----------------------:|-------------------:|-------------------------:|------------------:|--------------------:|-------------------:|-------------------:|---------------:|-------------------:|---------------:|---------------------:|-------------------:|-------------------:|-------------------:|--------------:|--------------:|----------------:|---------------------------:|---------------------------:|---------------------------------------:|--------------------------------:|--------------------------------:|--------------------------------:|--------------------------------------------:|----------------------------------:|---------------------------:|---------------------------------------:|-----------------------------:|----------------------:|--------------------------:|--------------------------:|--------------------------:|----------------------:|--------------------------:|----------------------:|----------------------------:|---------------------:|-----------------------:|---------------------:|---------------------:|-----------------:|---------------------:|-----------------:|-----------------------:|----------------:|------------------:|--------------------:|--------------------:|----------------:|--------------------:|----------------:|----------------------:|---------------:|-----------------:|\n|OPEC (EIA)     | 2009|NA       |         NA|           NA|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|                   NA|                   NA|                   NA|              NA|              NA|                NA|                 NA|                     NA|                       NA|                  4.591|                389.363|                NA|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|                  NA|                  NA|             NA|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|                  NA|                  NA|             NA|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                   8870.637|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|North Korea    | 1997|PRK      |   22827378| 3.601876e+10|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|               -1.905|               -2.972|             6704.233|         153.040|              NA|                NA|                 NA|                     NA|                       NA|                 -3.371|                 -9.937|         12476.232|          7.907|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|               0.000|               0.000|          0.000|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|               0.000|               0.000|          0.000|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                    284.800|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|United States  | 1939|USA      |  137254990| 1.469481e+12|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|               13.088|              350.735|            22079.400|        3030.508|              NA|                NA|                 NA|                     NA|                       NA|                     NA|                     NA|                NA|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|               7.841|              61.405|            6153.048|        844.536|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|               4.167|              79.537|           14484.733|       1988.102|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                         NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|Ghana          | 1911|GHA      |    2945501|           NA|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|                   NA|                   NA|                   NA|              NA|              NA|                NA|                 NA|                     NA|                       NA|                     NA|                     NA|                NA|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|                  NA|                  NA|             NA|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|               0.000|               0.000|          0.000|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                         NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|Czechoslovakia | 1977|NA       |   14979950| 1.850366e+11|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|                2.326|               12.098|            35522.613|         532.127|              NA|                NA|                 NA|                     NA|                       NA|                     NA|                     NA|                NA|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|              17.353|               1.483|             669.443|         10.028|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|              -6.107|              -0.093|              95.494|          1.430|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                         NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|United States  | 1942|USA      |  141912292| 2.013171e+12|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|               12.704|              491.974|            30755.436|        4364.574|              NA|                NA|                 NA|                     NA|                       NA|                     NA|                     NA|                NA|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|               6.348|              61.405|            7249.203|       1028.751|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|              -1.111|             -24.493|           15356.990|       2179.346|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                         NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|Albania        | 2001|ALB      |    3153615| 1.656384e+10|                      NA|                      NA|                      NA|                  NA|                       0|                   0|                  0|                   NA|                56.300|                   NA|                   NA|                   NA|               NA|                    0|                0|              -30.000|               -0.025|               18.223|           0.057|               0|                NA|               5.48|                   3.73|                       NA|                 -5.216|                 -1.499|          8635.532|          1.644|                     NA|                     NA|                 53.906|               0.17|                       NA|                      NA|             4.558|                  NA|                  NA|                  NA|              NA|               0.000|             0.0|                    NA|               0.000|               0.000|             102.880|          0.324|           0.00|               NA|                     0.21|                    NA|                    NA|                NA|              1128.863|              3.56|                      NA|           95.442|                 NA|                         NA|                         NA|                     NA|                   1128.863|                   3.56|                           NA|                95.442|                      NA|             1.75|                        31.934|                      NA|                      NA|                  NA|                   0.000|                0.00|                        NA|              0.000|                   NA|                  NA|                  NA|              NA|              53.906|            0.17|                    NA|               4.946|               0.189|            1274.061|          4.018|          4.558|               NA|                          NA|                           0|                                       0|                               NA|                               NA|                                0|                                            0|                                 NA|                           0|                                       0|                            NA|               1182.770|                     27.233|                         NA|                         NA|                     NA|                   1128.863|                   3.56|                           NA|                95.442|                      NA|                    NA|                    NA|                NA|                     0|                 0|                      NA|                0|                 NA|                   NA|                   NA|               NA|                    0|                0|                     NA|               0|                NA|\n|Europe         | 1900|NA       |  406629896|           NA|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|                   NA|                   NA|             8143.033|        3311.201|              NA|                NA|                 NA|                     NA|                       NA|                     NA|                     NA|                NA|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|                  NA|               0.000|          0.000|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|                  NA|             314.353|        127.825|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                         NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|Ethiopia       | 1980|ETH      |   34945472| 3.808297e+10|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|                   NA|                   NA|                0.000|           0.000|              NA|                NA|                 NA|                     NA|                       NA|                     NA|                     NA|           252.733|          0.232|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|                  NA|               0.000|          0.000|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|                  NA|               0.000|          0.000|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                      8.832|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|Armenia        | 2007|ARM      |    3004398| 2.861039e+10|                      NA|                      NA|                      NA|                  NA|                       0|                   0|                  0|                   NA|               136.201|                   NA|                   NA|                   NA|               NA|                    0|                0|                   NA|                0.000|                0.000|           0.000|               0|                NA|               5.55|                   5.58|                       NA|                 12.214|                  4.458|         13633.888|          1.432|                     NA|                     NA|                465.984|               1.40|                       NA|                      NA|            25.090|                  NA|                  NA|                  NA|              NA|             465.984|             1.4|                    NA|                  NA|               0.000|               0.000|          0.000|          25.09|               NA|                     0.76|                    NA|                    NA|                NA|               609.107|              1.83|                      NA|           32.796|                 NA|                         NA|                         NA|                     NA|                   1391.294|                   4.18|                           NA|                74.910|                      NA|            -0.03|                        -0.541|                      NA|                      NA|                  NA|                 782.187|                2.35|                        NA|             42.115|                   NA|                  NA|                  NA|              NA|               0.000|            0.00|                    NA|                  NA|               0.000|               0.000|          0.000|          0.000|               NA|                          NA|                           0|                                       0|                               NA|                               NA|                                0|                                            0|                                 NA|                           0|                                       0|                            NA|               1857.277|                     40.962|                         NA|                         NA|                     NA|                    609.107|                   1.83|                           NA|                32.796|                      NA|                    NA|                    NA|                NA|                     0|                 0|                      NA|                0|                 NA|                   NA|                   NA|               NA|                    0|                0|                     NA|               0|                NA|\n:::\n:::\n\n\nPremière question à se poser : Utiliserons-nous toutes ces variables?  \nSûrement pas, d'autant plus qu'il semble y avoir beaucoup d'informations manquantes. Nous y reviendrons...\n\n### Espérance de vie\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(slice_sample(data_life, n = 10))\n```\n\n::: {.cell-output-display}\n|geo |name                     | time| Life expectancy|\n|:---|:------------------------|----:|---------------:|\n|aus |Australia                | 2021|           83.19|\n|caf |Central African Republic | 1830|           30.00|\n|can |Canada                   | 1893|           45.91|\n|ury |Uruguay                  | 2078|           85.39|\n|syc |Seychelles               | 1920|           51.18|\n|isl |Iceland                  | 2019|           84.08|\n|bel |Belgium                  | 1927|           57.37|\n|ken |Kenya                    | 1830|           25.50|\n|gmb |Gambia                   | 1806|           28.80|\n|svn |Slovenia                 | 1867|           36.60|\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# quelques info utiles sur le fichier\n#file.info(fpath_energy)\n\n# paste avec le file.path quand on ouvre\n```\n:::\n\n\n\n## Nettoyage des données\n\nÀ première vue, les données semblent être bien arrangées et *tidy*. Rien de trop grave ne saute aux yeux.  \nUniformisons cependant les noms des colonnes entre les deux jeux de données en les nettoyant un peu par le fait même.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# renommer les titres de colonnes de data_life pour concorder avec ceux de data_energy\ndata_life_clean <- data_life %>%\n    dplyr::rename(life_expectancy = `Life expectancy`,\n                  year = `time`,\n                  country = `name`,\n                  iso_code = `geo`)\n```\n:::\n\n\nLes codes ISO des pays devraient aussi être uniformisés pour les avoir en majuscules dans les deux jeux.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# convertir les codes ISO du jeux data_life pour qu'ils soient en majuscules\n# inspiré de : https://stackoverflow.com/questions/16516593/convert-from-lowercase-to-uppercase-all-values-in-all-character-variables-in-dat\ndata_life_clean$iso_code <- toupper(data_life_clean$iso_code)\n```\n:::\n\n\n\n\n## Manipulations\n\nNous ne conservons que les variables qui nous intéressent du jeux Energy. Nous nous attarderons donc seulement à l'énergie **consommée**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy_cons <- data_energy %>%\n    select(iso_code,\n           country,\n           year,\n           population,\n           contains(\"cons\")\n           )\n\nkable(slice_sample(data_energy_cons, n = 10))\n```\n\n::: {.cell-output-display}\n|iso_code |country                       | year| population| biofuel_cons_change_pct| biofuel_cons_change_twh| biofuel_cons_per_capita| biofuel_consumption| coal_cons_change_pct| coal_cons_change_twh| coal_cons_per_capita| coal_consumption| energy_cons_change_pct| energy_cons_change_twh| fossil_cons_change_pct| fossil_cons_change_twh| fossil_fuel_consumption| gas_cons_change_pct| gas_cons_change_twh| gas_consumption| hydro_cons_change_pct| hydro_cons_change_twh| hydro_consumption| low_carbon_cons_change_pct| low_carbon_cons_change_twh| low_carbon_consumption| nuclear_cons_change_pct| nuclear_cons_change_twh| nuclear_consumption| oil_cons_change_pct| oil_cons_change_twh| oil_consumption| other_renewable_consumption| other_renewables_cons_change_pct| other_renewables_cons_change_twh| primary_energy_consumption| renewables_cons_change_pct| renewables_cons_change_twh| renewables_consumption| solar_cons_change_pct| solar_cons_change_twh| solar_consumption| wind_cons_change_pct| wind_cons_change_twh| wind_consumption|\n|:--------|:-----------------------------|----:|----------:|-----------------------:|-----------------------:|-----------------------:|-------------------:|--------------------:|--------------------:|--------------------:|----------------:|----------------------:|----------------------:|----------------------:|----------------------:|-----------------------:|-------------------:|-------------------:|---------------:|---------------------:|---------------------:|-----------------:|--------------------------:|--------------------------:|----------------------:|-----------------------:|-----------------------:|-------------------:|-------------------:|-------------------:|---------------:|---------------------------:|--------------------------------:|--------------------------------:|--------------------------:|--------------------------:|--------------------------:|----------------------:|---------------------:|---------------------:|-----------------:|--------------------:|--------------------:|----------------:|\n|MMR      |Myanmar                       | 1924|   12449784|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                     NA|                     NA|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                         NA|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|ZAF      |South Africa                  | 1926|    8458119|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                     NA|                     NA|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                         NA|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|PER      |Peru                          | 1954|    8583405|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                     NA|                     NA|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                         NA|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|VNM      |Vietnam                       | 1903|   13286043|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                     NA|                     NA|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                         NA|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|SWE      |Sweden                        | 1953|    7169979|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                     NA|                     NA|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                         NA|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|ARG      |Argentina                     | 1907|    6081424|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                     NA|                     NA|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                         NA|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|FIN      |Finland                       | 1991|    5013856|                      NA|                       0|                       0|                   0|               -0.124|               -0.076|            12208.500|           61.212|                  2.324|                  7.505|                  0.118|                  0.259|                 220.412|               5.395|               1.360|          26.570|                21.522|                 6.912|            39.026|                      7.050|                      7.246|                109.966|                   1.539|                   0.833|              54.979|              -0.767|              -1.025|         132.631|                      15.958|                           -3.045|                           -0.501|                    330.379|                     13.617|                      6.412|                 54.987|                     0|                     0|             0.001|                   NA|                0.002|            0.002|\n|SLE      |Sierra Leone                  | 1985|    3749425|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                  9.699|                  0.304|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                      3.443|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|NA       |Upper-middle-income countries | 1985| 1819847676|                      NA|                      NA|                      NA|                  NA|               -6.993|             -668.438|             4885.191|         8890.304|                -11.671|              -3103.611|                -12.149|              -2963.457|               21428.572|             -17.661|           -1083.681|        5052.266|                -2.256|               -37.738|          1634.934|                     -7.072|                   -149.365|               2011.283|                 -23.888|                -113.025|             360.110|             -13.928|           -1211.336|        7486.002|                      16.239|                            9.571|                            1.398|                  23489.111|                     -2.156|                    -36.340|               1651.174|                    NA|                     0|             0.000|                   NA|                0.000|            0.000|\n|LCA      |Saint Lucia                   | 2020|     179245|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                     NA|                     NA|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                         NA|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n:::\n:::\n\n\nDéjà beaucoup mieux, nous sommes passé de 129 à 45 variables. \nMais il y encore encore beaucoup de bruit, réduisons encore un peu plus.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy_cons <- data_energy_cons %>%\n    select(iso_code,\n           country,\n           year,\n           population,\n           contains(\"consumption\")\n           )\n\nkable(slice_sample(data_energy_cons, n = 10))\n```\n\n::: {.cell-output-display}\n|iso_code |country              | year| population| biofuel_consumption| coal_consumption| fossil_fuel_consumption| gas_consumption| hydro_consumption| low_carbon_consumption| nuclear_consumption| oil_consumption| other_renewable_consumption| primary_energy_consumption| renewables_consumption| solar_consumption| wind_consumption|\n|:--------|:--------------------|----:|----------:|-------------------:|----------------:|-----------------------:|---------------:|-----------------:|----------------------:|-------------------:|---------------:|---------------------------:|--------------------------:|----------------------:|-----------------:|----------------:|\n|TJK      |Tajikistan           | 2001|    6408813|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                     61.559|                     NA|                NA|               NA|\n|IRN      |Iran                 | 2011|   76342968|                  NA|           16.599|                2501.966|        1531.926|            29.473|                 30.414|               0.283|         953.441|                       0.070|                   2532.380|                 30.130|             0.002|            0.585|\n|SYR      |Syria                | 1911|    1966311|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|BRA      |Brazil               | 2010|  196353504|             159.434|          168.198|                1708.780|         275.768|          1119.363|               1425.485|              38.681|        1264.815|                     101.967|                   3134.266|               1386.804|             0.000|            6.041|\n|NA       |Low-income countries | 1995|  340649422|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                    663.834|                     NA|                NA|               NA|\n|HUN      |Hungary              | 1930|    8610568|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|TUR      |Turkey               | 1932|   15560613|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|FLK      |Falkland Islands     | 2016|       3527|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                      0.208|                     NA|                NA|               NA|\n|THA      |Thailand             | 1903|    7776763|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|CHN      |China                | 1961|  655260352|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n:::\n:::\n\n\n**revoir cette dernière partie, pas encore fonctionnelle**\n\nAprès une analyse un peu plus poussée des jeux de données, nous constatons que les observations du jeu *Energy* sont parfois celles d'un pays et d'autres, celles d'un continent. Il serait donc préférable de séparer ce jeux en deux. Puisque les continents n'ont pas de donnée inscrite à la colonne *iso_code*, nous pouvons utiliser cette caractéristique pour les extraire.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy_cons_continent <- data_energy_cons %>%\n    dplyr::filter(is.na(iso_code))\n```\n:::\n\n\nOn remarque toutefois, outre les nombreuses régions et autres subdivisions énumérées, que certains pays n'avaient pas de code ISO et ont donc été inclus :  \nAfrica, Africa (BP), Africa (Ember), Africa (Shift), Asia, Asia & Oceania (EIA), Asia (Ember), Asia Pacific (BP), Asia and Oceania (Shift), Australia and New Zealand (EIA), CIS (BP), Central & South America (EIA), Central America (BP), Central and South America (Shift), Czechoslovakia, EU28 (Shift), East Germany (EIA), Eastern Africa (BP), Eurasia (EIA), Eurasia (Shift), Europe, Europe (BP), Europe (Ember), Europe (Shift), European Union (27), European Union (27) (Ember), European Union (EIA), G20 (Ember), G7 (Ember), Hawaiian Trade Zone (EIA), High-income countries, IEO - Africa (EIA), IEO - Middle East (EIA), IEO OECD - Europe (EIA), Inde (Shift), Kosovo, Latin America and Caribbean (Ember), Low-income countries, Lower-middle-income countries, Mexico, Chile, and other OECD Americas (EIA), Middle Africa (BP), Middle East (BP), Middle East (EIA), Middle East (Shift), Non-OECD (BP), Non-OECD (EIA), Non-OPEC (EIA), North America, North America (BP), North America (Ember), North America (Shift), OECD (BP), OECD (EIA), OECD (Ember), OECD (Shift), OECD - Asia And Oceania (EIA), OECD - Europe (EIA), OECD - North America (EIA), OPEC (EIA), OPEC (Shift), OPEC - Africa (EIA), OPEC - South America (EIA), Oceania, Oceania (Ember), Other Africa (BP), Other Asia Pacific (BP), Other CIS (BP), Other Caribbean (BP), Other Eastern Africa (BP), Other Europe (BP), Other Middle Africa (BP), Other Middle East (BP), Other Non-OECD - America (EIA), Other Non-OECD - Asia (EIA), Other Non-OECD - Europe and Eurasia (EIA), Other Northern Africa (BP), Other South America (BP), Other South and Central America (BP), Other Southern Africa (BP), Other Western Africa (BP), Persian Gulf (EIA), Persian Gulf (Shift), Serbia and Montenegro, South America, South Korea and other OECD Asia (EIA), South and Central America (BP), Total Non-OPEC (BP), Total OPEC (BP), U.S. Pacific Islands (EIA), U.S. Pacific Islands (Shift), U.S. Territories (EIA), U.S. Territories (Shift), USSR, Upper-middle-income countries, Wake Island (EIA), Wake Island (Shift), West Germany (EIA), Western Africa (BP), World, Yugoslavia\n\nNous les retirerons alors aussi du jeux principal, question d'avoir des données le plus complètes possible.\n\nEt pour simplifier notre jeu sur les continents, nous ne retiendrons que l'essentiel.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy_cons_continent <- data_energy_cons_continent %>%\n    dplyr::filter(iso_code == \"Africa\")\n```\n:::\n\n\n\n### Ajout d'une variable *continents*\n\nURL de la source des données pour réaliser la tâche :  \n[https://ourworldindata.org/grapher/continents-according-to-our-world-in-data?tab=table](https://ourworldindata.org/grapher/continents-according-to-our-world-in-data?tab=table)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhtml <- \"https://ourworldindata.org/grapher/continents-according-to-our-world-in-data?tab=table\"\n\ndata_continents <- read_html(x = html) %>%\n    html_element(css = \".data-table\") #%>% \n    #html_table()\n```\n:::\n\n\n## Sauvegarde de nos jeux de données nettoyées\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_csv(data_energy_cons, file = \"data/processed/owid-energy-consumption-data.csv\")\nwrite_csv(data_life_clean, file = \"data/processed/gm-life-expectancy-data.csv\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}