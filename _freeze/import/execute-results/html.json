{
  "hash": "f09691cf4fb209475cef2302818c5e07",
  "result": {
    "markdown": "---\ntitle: \"Importation des données\"\ntitle-block-banner: false\ndescription: | \n  Petite description de cette page.\n# à changer\ndate: \"2022-12-21\"\n# Modifier les détails que vous voulez\nauthor:\n  - name: \"Amélie Levasseur-Raymond\"\n    # Votre site web perso ou github\n    url: https://amelie-lr.github.io/\n    # les champs d'affiliation sont optionnels, vous pouvez les\n    # comment out en ajoutant un # devant.\n    affiliation: FAS1002\n    affiliation-url: https://FAS1002.github.io/A22\n    # changer pour votre propre orcid id\n    # https://orcid.org/ pour vous inscrire.\n    # orcid: 0000-0000-0000-0000\n\n# TRUE == Générer une citation pour cette page précise. Pour enlever, mettre false.\ncitation: true\n# Inclure les références que vous utilisez dans vos rapports. Je conseille Zotero pour construire\n# ce fichier ou de connecter RStudio directement pour pouvoir citer avec @nom-de-reference.\nbibliography: references.bib\n---\n\n\n\n::: callout-important\nN'oubliez pas d'inclure vos références sur chacune des pages!\n:::\n\nPar exemple:\n\n> Les données proviennent entre autres de @owidenergy.\n\n\n::: {.cell}\n\n:::\n\n\n## Téléchargement des données\n\n### Our World in Data - Energy\n\n> Les données proviennent de @owidenergy.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# chemin relatif vers le dossier qui contient les données brutes\nbase_path <- path(\"data\", \"raw\")\n\nurl_energy <- \"https://nyc3.digitaloceanspaces.com/owid-public/data/energy/owid-energy-data.csv\"\n\n# personnaliser le nom du fichier téléchargé en y ajoutant la date du jour\nfname_energy <- paste(today(), \"owid-energy-data.csv\", sep = \"_\")\n# établir le chemin relatif complet de notre fichier personnalisé téléchargé\nfpath_energy <- path(base_path, fname_energy)\n\n# télécharger les données seulement si elles n'ont pas déjà été téléchargées aujourd'hui\n# inspiré de : https://stackoverflow.com/questions/14904983/how-do-i-check-the-existence-of-a-downloaded-file\n# télécharge seulement si le fichier en date du jour n'existe pas en supprimant l'ancienne version\nif (!file.exists(fpath_energy)) {\n    file.remove(paste(base_path, dir(path = base_path, pattern = \"*_owid-energy-data.csv\"), sep = \"/\"))\n    download.file(url = url_energy, \n              destfile = fpath_energy)\n}\n```\n:::\n\n\nLe fichier a été téléchargé ici : **data/raw/2022-12-17_owid-energy-data.csv**\n\n### Gapminder - Life Expectancy at Birth\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# url prise de Download lastest version : Excel file\nurl_life <- \"https://docs.google.com/spreadsheets/d/1RheSon1-q4vFc3AGyupVPH6ptEByE-VtnjOCselU0PE/export?format=xlsx\"\n\n# pour ne pas avoir de demande d'authentification Google\ngs4_deauth()\n\n# date sans le jour (année-mois)\ntoday_month <- paste(year(today()), month(today()), sep = \"-\")\n# personnaliser le nom du fichier téléchargé en y ajoutant la date du jour\nfname_life <- paste(today_month, \"gm-life-expectancy-data.xlsx\", sep = \"_\")\n# établir le chemin relatif complet de notre fichier personnalisé téléchargé\nfpath_life <- path(base_path, fname_life)\n\nif (!file.exists(fpath_life)) {\n    file.remove(paste(base_path, dir(path = base_path, pattern = \"*_gm-life-expectancy-data.xlsx\"), sep = \"/\"))\n    download.file(url = url_life, \n              destfile = fpath_life)\n}\n```\n:::\n\n\nLe fichier a été téléchargé ici : **data/raw/2022-12_gm-life-expectancy-data.xlsx**\n\nNous constatons maintenant que notre dossier contient les fichiers suivants :  \ndata/raw/2022-12-17_owid-energy-data.csv, data/raw/2022-12_gm-life-expectancy-data.xlsx\n\n## Premier coup d'oeil\n\nVoyons d'abord plus en détails ce que nous avons comme données.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy <- as_tibble(read_csv(file = fpath_energy))\n\ndata_life <- as_tibble(read_excel(fpath_life, sheet = \"data-for-countries-etc-by-year\", range = NULL, trim_ws = TRUE, col_names = TRUE))\n```\n:::\n\n\n### Énergie\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(slice_sample(data_energy, n = 10))\n```\n\n::: {.cell-output-display}\n|country                       | year|iso_code | population|          gdp| biofuel_cons_change_pct| biofuel_cons_change_twh| biofuel_cons_per_capita| biofuel_consumption| biofuel_elec_per_capita| biofuel_electricity| biofuel_share_elec| biofuel_share_energy| carbon_intensity_elec| coal_cons_change_pct| coal_cons_change_twh| coal_cons_per_capita| coal_consumption| coal_elec_per_capita| coal_electricity| coal_prod_change_pct| coal_prod_change_twh| coal_prod_per_capita| coal_production| coal_share_elec| coal_share_energy| electricity_demand| electricity_generation| electricity_share_energy| energy_cons_change_pct| energy_cons_change_twh| energy_per_capita| energy_per_gdp| fossil_cons_change_pct| fossil_cons_change_twh| fossil_elec_per_capita| fossil_electricity| fossil_energy_per_capita| fossil_fuel_consumption| fossil_share_elec| fossil_share_energy| gas_cons_change_pct| gas_cons_change_twh| gas_consumption| gas_elec_per_capita| gas_electricity| gas_energy_per_capita| gas_prod_change_pct| gas_prod_change_twh| gas_prod_per_capita| gas_production| gas_share_elec| gas_share_energy| greenhouse_gas_emissions| hydro_cons_change_pct| hydro_cons_change_twh| hydro_consumption| hydro_elec_per_capita| hydro_electricity| hydro_energy_per_capita| hydro_share_elec| hydro_share_energy| low_carbon_cons_change_pct| low_carbon_cons_change_twh| low_carbon_consumption| low_carbon_elec_per_capita| low_carbon_electricity| low_carbon_energy_per_capita| low_carbon_share_elec| low_carbon_share_energy| net_elec_imports| net_elec_imports_share_demand| nuclear_cons_change_pct| nuclear_cons_change_twh| nuclear_consumption| nuclear_elec_per_capita| nuclear_electricity| nuclear_energy_per_capita| nuclear_share_elec| nuclear_share_energy| oil_cons_change_pct| oil_cons_change_twh| oil_consumption| oil_elec_per_capita| oil_electricity| oil_energy_per_capita| oil_prod_change_pct| oil_prod_change_twh| oil_prod_per_capita| oil_production| oil_share_elec| oil_share_energy| other_renewable_consumption| other_renewable_electricity| other_renewable_exc_biofuel_electricity| other_renewables_cons_change_pct| other_renewables_cons_change_twh| other_renewables_elec_per_capita| other_renewables_elec_per_capita_exc_biofuel| other_renewables_energy_per_capita| other_renewables_share_elec| other_renewables_share_elec_exc_biofuel| other_renewables_share_energy| per_capita_electricity| primary_energy_consumption| renewables_cons_change_pct| renewables_cons_change_twh| renewables_consumption| renewables_elec_per_capita| renewables_electricity| renewables_energy_per_capita| renewables_share_elec| renewables_share_energy| solar_cons_change_pct| solar_cons_change_twh| solar_consumption| solar_elec_per_capita| solar_electricity| solar_energy_per_capita| solar_share_elec| solar_share_energy| wind_cons_change_pct| wind_cons_change_twh| wind_consumption| wind_elec_per_capita| wind_electricity| wind_energy_per_capita| wind_share_elec| wind_share_energy|\n|:-----------------------------|----:|:--------|----------:|------------:|-----------------------:|-----------------------:|-----------------------:|-------------------:|-----------------------:|-------------------:|------------------:|--------------------:|---------------------:|--------------------:|--------------------:|--------------------:|----------------:|--------------------:|----------------:|--------------------:|--------------------:|--------------------:|---------------:|---------------:|-----------------:|------------------:|----------------------:|------------------------:|----------------------:|----------------------:|-----------------:|--------------:|----------------------:|----------------------:|----------------------:|------------------:|------------------------:|-----------------------:|-----------------:|-------------------:|-------------------:|-------------------:|---------------:|-------------------:|---------------:|---------------------:|-------------------:|-------------------:|-------------------:|--------------:|--------------:|----------------:|------------------------:|---------------------:|---------------------:|-----------------:|---------------------:|-----------------:|-----------------------:|----------------:|------------------:|--------------------------:|--------------------------:|----------------------:|--------------------------:|----------------------:|----------------------------:|---------------------:|-----------------------:|----------------:|-----------------------------:|-----------------------:|-----------------------:|-------------------:|-----------------------:|-------------------:|-------------------------:|------------------:|--------------------:|-------------------:|-------------------:|---------------:|-------------------:|---------------:|---------------------:|-------------------:|-------------------:|-------------------:|--------------:|--------------:|----------------:|---------------------------:|---------------------------:|---------------------------------------:|--------------------------------:|--------------------------------:|--------------------------------:|--------------------------------------------:|----------------------------------:|---------------------------:|---------------------------------------:|-----------------------------:|----------------------:|--------------------------:|--------------------------:|--------------------------:|----------------------:|--------------------------:|----------------------:|----------------------------:|---------------------:|-----------------------:|---------------------:|---------------------:|-----------------:|---------------------:|-----------------:|-----------------------:|----------------:|------------------:|--------------------:|--------------------:|----------------:|--------------------:|----------------:|----------------------:|---------------:|-----------------:|\n|Guyana                        | 1987|GUY      |     763716|           NA|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|                   NA|                0.000|                0.000|           0.000|              NA|                NA|                 NA|                     NA|                       NA|                -23.994|                 -1.345|          5578.719|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|               0.000|               0.000|          0.000|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|               0.000|               0.000|          0.000|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                      4.261|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|French Polynesia              | 1986|PYF      |     192213|           NA|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|                   NA|                0.000|                0.000|           0.000|              NA|                NA|                 NA|                     NA|                       NA|                 26.794|                  0.868|         21374.791|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|               0.000|               0.000|          0.000|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|               0.000|               0.000|          0.000|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                      4.109|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|Eritrea                       | 1999|ERI      |    2356488|           NA|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|                   NA|                0.000|                0.000|           0.000|              NA|                NA|                 NA|                     NA|                       NA|                  3.795|                  0.185|          2150.386|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|               0.000|               0.000|          0.000|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|               0.000|               0.000|          0.000|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                      5.067|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|Total OPEC (BP)               | 1966|NA       |         NA|           NA|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|                   NA|                   NA|                   NA|              NA|              NA|                NA|                 NA|                     NA|                       NA|                     NA|                     NA|                NA|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|                  NA|                  NA|             NA|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|               9.953|             796.129|                  NA|       8794.916|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                         NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|India                         | 1989|IND      |  852012672| 1.663728e+12|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                8.694|               94.384|             1384.887|         1179.941|              217.104|          184.975|                8.747|               92.292|             1346.726|        1147.427|          67.894|            55.050|                 NA|                272.446|                   12.711|                  9.230|                181.112|          2515.706|          1.288|                  9.030|                161.055|                240.671|            205.055|                 2282.382|                1944.618|            75.264|              90.725|              18.894|              15.400|          96.905|               8.539|           7.275|               113.736|              18.894|              15.400|             113.736|         96.905|          2.670|            4.521|                       NA|                16.030|                25.888|           187.384|                74.377|            63.370|                 219.931|           23.260|              8.742|                     11.039|                     20.057|                198.795|                     79.097|                 67.391|                      233.324|                24.736|                   9.275|               NA|                            NA|                 -33.818|                  -5.831|              11.412|                   4.720|               4.022|                    13.394|              1.476|                0.532|               8.317|              51.272|         667.773|              15.029|          12.805|               783.759|               6.700|              25.156|             470.230|        400.642|          4.700|           31.155|                       0.000|                       0.000|                                      NA|                               NA|                            0.000|                            0.000|                                           NA|                              0.000|                       0.000|                                      NA|                         0.000|                319.768|                   2143.414|                     16.030|                     25.888|                187.384|                     74.377|                 63.370|                      219.931|                23.260|                   8.742|                    NA|                 0.000|             0.000|                 0.000|              0.00|                   0.000|            0.000|              0.000|                   NA|                0.000|            0.000|                0.000|             0.00|                  0.000|           0.000|             0.000|\n|Belgium                       | 2008|BEL      |   10726720| 4.083149e+11|                      NA|                   0.000|                   0.000|               0.000|                 310.440|                3.33|              3.995|                0.000|               239.952|               -1.242|               -0.671|             4970.397|           53.316|              517.400|            5.550|                   NA|                0.000|                0.000|           0.000|           6.659|             6.873|              93.95|                 83.350|                   10.745|                  1.606|                 12.265|         72317.914|          1.900|                  2.793|                 17.366|               3109.991|             33.360|                59586.902|                 639.172|            40.024|              82.396|              -0.671|              -1.176|         174.014|            2298.000|          24.650|             16222.526|                  NA|               0.000|               0.000|          0.000|         29.574|           22.432|                    20.00|                 5.398|                 0.052|             1.152|                38.222|             0.410|                 107.407|            0.492|              0.149|                     -3.340|                     -5.101|                136.562|                   4660.325|                 49.990|                    12731.016|                59.976|                  17.604|            10.60|                        11.283|                  -5.514|                  -7.983|             122.875|                4248.270|              45.570|                 11455.043|             54.673|               15.840|               4.893|              19.212|         411.841|             294.591|           3.160|             38393.973|                  NA|               0.000|               0.000|          0.000|          3.791|           53.091|                      10.627|                       3.330|                                       0|                           28.038|                            2.327|                          310.440|                                            0|                            990.689|                       3.995|                                       0|                         1.370|               7770.315|                    775.734|                     26.736|                      2.882|                 13.687|                    412.055|                  4.420|                     1275.973|                 5.303|                   1.764|               600.000|                 0.101|             0.118|                 3.729|              0.04|                  11.003|            0.048|              0.015|               29.735|                0.402|            1.790|               59.664|             0.64|                166.874|           0.768|             0.231|\n|China                         | 2018|CHN      | 1417069440| 1.815162e+13|                  29.635|                   7.781|                  24.019|              34.036|                  66.144|               93.73|              1.316|                0.088|               573.827|                0.612|              136.900|            15888.271|        22514.783|             3361.811|         4763.920|                5.052|             1026.840|            15068.386|       21352.949|          66.903|            58.361|            7105.38|               7120.600|                   18.457|                  3.951|               1466.426|         27224.191|          2.125|                  2.862|                915.131|               3521.549|           4990.280|                23208.959|               32888.707|            70.082|              85.251|              17.688|             426.738|        2839.260|             152.074|         215.500|              2003.614|               8.190|             122.194|            1139.103|       1614.189|          3.026|            7.360|                  4085.99|                 2.903|                71.352|          3171.928|               846.035|          1198.890|                2238.371|           16.837|              8.222|                     11.483|                    551.298|               5689.863|                   1503.328|               2130.320|                     4015.232|                29.918|                  14.749|           -15.22|                        -0.214|                  18.904|                 115.366|             748.955|                 208.176|             295.000|                   528.524|              4.143|                1.941|               4.893|             351.490|        7534.662|               7.664|          10.860|              5317.073|              -1.139|             -25.377|            1553.797|       2201.838|          0.153|           19.531|                     299.108|                      93.725|                                      NA|                           17.747|                           45.092|                           66.140|                                           NA|                            211.075|                       1.316|                                      NA|                         0.775|               5024.877|                  38578.570|                     10.396|                    435.933|               4940.909|                   1295.152|               1835.320|                     3486.709|                25.775|                  12.807|                50.170|               154.529|           468.029|               124.835|            176.90|                 330.280|            2.484|              1.213|               20.092|              157.178|          967.807|              258.138|           365.80|                682.964|           5.137|             2.509|\n|Peru                          | 2013|PER      |   30038810| 3.298918e+11|                      NA|                      NA|                      NA|                  NA|                  15.979|                0.48|              1.152|                   NA|               264.586|                0.854|                0.087|              340.846|           10.239|               16.312|            0.490|               -8.547|               -0.237|               84.444|           2.537|           1.176|             3.835|              41.65|                 41.650|                   15.602|                  2.216|                  5.788|          8887.071|          0.809|                  1.946|                  3.788|                627.189|             18.840|                 6606.511|                 198.452|            45.234|              74.338|              -2.319|              -1.592|          67.027|             456.077|          13.700|              2231.336|               3.688|               4.411|            4127.702|        123.991|         32.893|           25.108|                    11.02|                 1.306|                 0.420|            60.830|               735.382|            22.090|                2025.055|           53.037|             22.787|                      3.150|                      1.725|                 64.435|                    759.351|                 22.810|                     2145.047|                54.766|                  24.137|             0.00|                         0.000|                      NA|                   0.000|               0.000|                   0.000|               0.000|                     0.000|              0.000|                0.000|               4.567|               5.293|         121.186|             154.800|           4.650|              4034.329|               6.545|               5.226|            2831.911|         85.067|         11.164|           45.395|                       3.065|                       0.480|                                       0|                           43.713|                            0.932|                           15.979|                                            0|                            102.019|                       1.152|                                       0|                         1.148|               1386.540|                    266.957|                      3.150|                      1.725|                 64.435|                    759.351|                 22.810|                     2145.047|                54.766|                  24.137|               229.816|                 0.373|             0.537|                 7.990|              0.24|                  17.865|            0.576|              0.201|                0.000|                0.000|            0.003|                0.000|             0.00|                  0.109|           0.000|             0.001|\n|Lower-middle-income countries | 1972|NA       | 1315146462|           NA|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                4.614|               22.145|              381.793|          502.114|                   NA|               NA|                3.400|               18.416|              425.806|         559.998|              NA|            30.583|                 NA|                     NA|                       NA|                  5.280|                 82.339|          1248.367|             NA|                  5.767|                 80.954|                     NA|                 NA|                 1128.899|                1484.667|                NA|              90.430|               8.752|               7.996|          99.362|                  NA|              NA|                75.552|              27.620|              45.939|             161.398|        212.262|             NA|            6.052|                       NA|                 0.709|                 1.084|           153.920|                39.580|            52.053|                 117.036|               NA|              9.375|                      0.897|                      1.385|                157.118|                     40.437|                 53.180|                      119.468|                    NA|                   9.570|               NA|                            NA|                  10.390|                   0.301|               3.198|                   0.857|               1.127|                     2.431|                 NA|                0.195|               6.105|              50.813|         883.192|                  NA|              NA|               671.554|              14.210|             690.671|            4220.871|       5551.064|             NA|           53.795|                       0.000|                       0.000|                                      NA|                               NA|                            0.000|                            0.000|                                           NA|                              0.000|                          NA|                                      NA|                         0.000|                     NA|                   1641.785|                      0.709|                      1.084|                153.920|                     39.580|                 52.053|                      117.036|                    NA|                   9.375|                    NA|                 0.000|             0.000|                 0.000|              0.00|                   0.000|               NA|              0.000|                   NA|                0.000|            0.000|                0.000|             0.00|                  0.000|              NA|             0.000|\n|Brazil                        | 1931|BRA      |   34518393| 4.432726e+10|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|               28.312|                0.682|               89.536|           3.091|              NA|                NA|                 NA|                     NA|                       NA|                     NA|                     NA|                NA|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|               0.000|               0.000|          0.000|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|               0.000|               0.000|          0.000|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                         NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n:::\n:::\n\n\nPremière question à se poser : Utiliserons-nous toutes ces variables?  \nSûrement pas, d'autant plus qu'il semble y avoir beaucoup d'informations manquantes. Nous y reviendrons...\n\n### Espérance de vie\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(slice_sample(data_life, n = 10))\n```\n\n::: {.cell-output-display}\n|geo |name                   | time| Life expectancy|\n|:---|:----------------------|----:|---------------:|\n|btn |Bhutan                 | 1979|           52.48|\n|com |Comoros                | 2060|           75.32|\n|lca |St. Lucia              | 1956|           56.27|\n|cmr |Cameroon               | 1905|           30.25|\n|bih |Bosnia and Herzegovina | 2028|           78.31|\n|zwe |Zimbabwe               | 1836|           33.70|\n|swz |Swaziland              | 2098|           71.59|\n|esp |Spain                  | 1833|           29.50|\n|mdg |Madagascar             | 2028|           68.22|\n|pol |Poland                 | 1888|           36.80|\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# quelques info utiles sur le fichier\n#file.info(fpath_energy)\n\n# paste avec le file.path quand on ouvre\n```\n:::\n\n\n\n## Nettoyage des données\n\nÀ première vue, les données semblent être bien arrangées et *tidy*. Rien de trop grave ne saute aux yeux.  \nUniformisons cependant les noms des colonnes entre les deux jeux de données en les nettoyant un peu par le fait même.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# renommer les titres de colonnes de data_life pour concorder avec ceux de data_energy\ndata_life_clean <- data_life %>%\n    dplyr::rename(life_expectancy = `Life expectancy`,\n                  year = `time`,\n                  country = `name`,\n                  iso_code = `geo`)\n```\n:::\n\n\nLes codes ISO des pays devraient aussi être uniformisés pour les avoir en majuscules dans les deux jeux.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# convertir les codes ISO du jeux data_life pour qu'ils soient en majuscules\n# inspiré de : https://stackoverflow.com/questions/16516593/convert-from-lowercase-to-uppercase-all-values-in-all-character-variables-in-dat\ndata_life_clean$iso_code <- toupper(data_life_clean$iso_code)\n```\n:::\n\n\nXxxx \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# pour remplir les cases vides de Province/Territoire\n#table[table == \"\"] <- NA\n```\n:::\n\n\n\n## Manipulations\n\nNous ne conservons que les variables qui nous intéressent du jeux Energy. Nous nous attarderons donc seulement à l'énergie **consommée**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy_cons <- data_energy %>%\n    select(iso_code,\n           country,\n           year,\n           population,\n           contains(\"cons\")\n           )\n\nkable(slice_sample(data_energy_cons, n = 10))\n```\n\n::: {.cell-output-display}\n|iso_code |country                      | year| population| biofuel_cons_change_pct| biofuel_cons_change_twh| biofuel_cons_per_capita| biofuel_consumption| coal_cons_change_pct| coal_cons_change_twh| coal_cons_per_capita| coal_consumption| energy_cons_change_pct| energy_cons_change_twh| fossil_cons_change_pct| fossil_cons_change_twh| fossil_fuel_consumption| gas_cons_change_pct| gas_cons_change_twh| gas_consumption| hydro_cons_change_pct| hydro_cons_change_twh| hydro_consumption| low_carbon_cons_change_pct| low_carbon_cons_change_twh| low_carbon_consumption| nuclear_cons_change_pct| nuclear_cons_change_twh| nuclear_consumption| oil_cons_change_pct| oil_cons_change_twh| oil_consumption| other_renewable_consumption| other_renewables_cons_change_pct| other_renewables_cons_change_twh| primary_energy_consumption| renewables_cons_change_pct| renewables_cons_change_twh| renewables_consumption| solar_cons_change_pct| solar_cons_change_twh| solar_consumption| wind_cons_change_pct| wind_cons_change_twh| wind_consumption|\n|:--------|:----------------------------|----:|----------:|-----------------------:|-----------------------:|-----------------------:|-------------------:|--------------------:|--------------------:|--------------------:|----------------:|----------------------:|----------------------:|----------------------:|----------------------:|-----------------------:|-------------------:|-------------------:|---------------:|---------------------:|---------------------:|-----------------:|--------------------------:|--------------------------:|----------------------:|-----------------------:|-----------------------:|-------------------:|-------------------:|-------------------:|---------------:|---------------------------:|--------------------------------:|--------------------------------:|--------------------------:|--------------------------:|--------------------------:|----------------------:|---------------------:|---------------------:|-----------------:|--------------------:|--------------------:|----------------:|\n|NA       |Other Caribbean (BP)         | 1983|         NA|                      NA|                      NA|                      NA|                  NA|              105.752|                1.205|                   NA|            2.345|                 -3.616|                -13.295|                 -4.250|                -14.745|                 332.173|              -0.795|              -0.002|           0.188|                13.065|                 0.470|             4.069|                     10.217|                      0.818|                  8.905|                      NA|                       0|                   0|              -4.615|             -15.949|         329.640|                       4.836|                            7.752|                            0.348|                    354.359|                     10.217|                      0.818|                  8.905|                    NA|                 0.000|             0.000|                   NA|                    0|            0.000|\n|OMN      |Oman                         | 1995|    2172681|                      NA|                      NA|                      NA|                  NA|              -45.509|                0.000|                0.035|            0.000|                 15.938|                  9.059|                 15.938|                  9.059|                  65.900|              22.332|               6.087|          33.344|                    NA|                 0.000|             0.000|                         NA|                      0.000|                  0.000|                      NA|                       0|                   0|              10.047|               2.972|          32.555|                       0.000|                               NA|                            0.000|                     65.900|                         NA|                      0.000|                  0.000|                    NA|                 0.000|             0.000|                   NA|                    0|            0.000|\n|NA       |U.S. Territories (EIA)       | 2014|         NA|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                     NA|                  0.000|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                      0.000|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|GAB      |Gabon                        | 1999|    1240778|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                 15.480|                  2.012|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                     15.012|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|COD      |Democratic Republic of Congo | 1917|    8158937|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                     NA|                     NA|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                         NA|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|SWZ      |Eswatini                     | 1971|     454928|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                     NA|                     NA|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                         NA|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|NA       |Middle Africa (BP)           | 2020|         NA|                      NA|                      NA|                      NA|                  NA|               19.565|                0.330|                   NA|            2.017|                 -1.433|                 -4.013|                 -5.214|                -10.439|                 189.764|               4.559|               2.306|          52.895|                 8.489|                 6.423|            85.819|                      8.457|                      6.426|                 86.197|                      NA|                      NA|                  NA|              -8.839|             -13.075|         134.851|                       0.168|                            0.274|                            0.000|                    275.961|                      8.457|                      6.426|                 86.197|                  1.81|                 0.003|             0.187|                0.274|                    0|            0.023|\n|NA       |USSR                         | 1956|  199817116|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                     NA|                     NA|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                         NA|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|NA       |Middle East (Shift)          | 1989|         NA|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                     NA|                     NA|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                         NA|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|IRN      |Iran                         | 1951|   17219634|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                     NA|                     NA|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                         NA|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n:::\n:::\n\n\nDéjà beaucoup mieux, nous sommes passé de 129 à 45 variables. \nMais il y encore encore beaucoup de bruit, réduisons encore un peu plus.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy_cons <- data_energy_cons %>%\n    select(iso_code,\n           country,\n           year,\n           population,\n           contains(\"consumption\")\n           )\n\nkable(slice_sample(data_energy_cons, n = 10))\n```\n\n::: {.cell-output-display}\n|iso_code |country                        | year| population| biofuel_consumption| coal_consumption| fossil_fuel_consumption| gas_consumption| hydro_consumption| low_carbon_consumption| nuclear_consumption| oil_consumption| other_renewable_consumption| primary_energy_consumption| renewables_consumption| solar_consumption| wind_consumption|\n|:--------|:------------------------------|----:|----------:|-------------------:|----------------:|-----------------------:|---------------:|-----------------:|----------------------:|-------------------:|---------------:|---------------------------:|--------------------------:|----------------------:|-----------------:|----------------:|\n|GHA      |Ghana                          | 1964|    7640202|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|CAN      |Canada                         | 1956|   16167046|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|MEX      |Mexico                         | 1905|   14074971|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|VEN      |Venezuela                      | 1935|    3833248|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|NA       |Low-income countries           | 1991|  302719388|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                    628.223|                     NA|                NA|               NA|\n|OMN      |Oman                           | 1945|     446064|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|CYP      |Cyprus                         | 2010|    1129693|                  NA|            0.170|                  33.674|           0.000|             0.000|                  0.217|               0.000|          33.504|                       0.112|                     34.056|                  0.217|             0.019|            0.086|\n|NA       |South and Central America (BP) | 2016|         NA|             227.233|          399.077|                5550.646|        1741.829|          1818.307|               2476.694|              62.037|        3409.739|                     235.078|                   8027.340|               2414.657|            13.020|          121.019|\n|SGP      |Singapore                      | 2017|    5764489|                  NA|           10.446|                 994.416|         122.877|             0.000|                  2.800|               0.000|         861.094|                       2.474|                    997.217|                  2.800|             0.327|            0.000|\n|NA       |OPEC - South America (EIA)     | 2010|         NA|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                    911.191|                     NA|                NA|               NA|\n:::\n:::\n\n\n**revoir cette dernière partie, pas encore fonctionnelle**\n\nAprès une analyse un peu plus poussée des jeux de données, nous constatons que les observations du jeu *Energy* sont parfois celles d'un pays et d'autres, celles d'un continent. Il serait donc préférable de séparer ce jeux en deux. Puisque les continents n'ont pas de donnée inscrite à la colonne *iso_code*, nous pouvons utiliser cette caractéristique pour les extraire.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy_cons_continent <- data_energy_cons %>%\n    dplyr::filter(is.na(iso_code))\n```\n:::\n\n\nOn remarque toutefois, outre les nombreuses régions et autres subdivisions énumérées, que certains pays n'avaient pas de code ISO et ont donc été inclus :  \nAfrica, Africa (BP), Africa (Ember), Africa (Shift), Asia, Asia & Oceania (EIA), Asia (Ember), Asia Pacific (BP), Asia and Oceania (Shift), Australia and New Zealand (EIA), CIS (BP), Central & South America (EIA), Central America (BP), Central and South America (Shift), Czechoslovakia, EU28 (Shift), East Germany (EIA), Eastern Africa (BP), Eurasia (EIA), Eurasia (Shift), Europe, Europe (BP), Europe (Ember), Europe (Shift), European Union (27), European Union (27) (Ember), European Union (EIA), G20 (Ember), G7 (Ember), Hawaiian Trade Zone (EIA), High-income countries, IEO - Africa (EIA), IEO - Middle East (EIA), IEO OECD - Europe (EIA), Inde (Shift), Kosovo, Latin America and Caribbean (Ember), Low-income countries, Lower-middle-income countries, Mexico, Chile, and other OECD Americas (EIA), Middle Africa (BP), Middle East (BP), Middle East (EIA), Middle East (Shift), Non-OECD (BP), Non-OECD (EIA), Non-OPEC (EIA), North America, North America (BP), North America (Ember), North America (Shift), OECD (BP), OECD (EIA), OECD (Ember), OECD (Shift), OECD - Asia And Oceania (EIA), OECD - Europe (EIA), OECD - North America (EIA), OPEC (EIA), OPEC (Shift), OPEC - Africa (EIA), OPEC - South America (EIA), Oceania, Oceania (Ember), Other Africa (BP), Other Asia Pacific (BP), Other CIS (BP), Other Caribbean (BP), Other Eastern Africa (BP), Other Europe (BP), Other Middle Africa (BP), Other Middle East (BP), Other Non-OECD - America (EIA), Other Non-OECD - Asia (EIA), Other Non-OECD - Europe and Eurasia (EIA), Other Northern Africa (BP), Other South America (BP), Other South and Central America (BP), Other Southern Africa (BP), Other Western Africa (BP), Persian Gulf (EIA), Persian Gulf (Shift), Serbia and Montenegro, South America, South Korea and other OECD Asia (EIA), South and Central America (BP), Total Non-OPEC (BP), Total OPEC (BP), U.S. Pacific Islands (EIA), U.S. Pacific Islands (Shift), U.S. Territories (EIA), U.S. Territories (Shift), USSR, Upper-middle-income countries, Wake Island (EIA), Wake Island (Shift), West Germany (EIA), Western Africa (BP), World, Yugoslavia\n\nNous les retirerons alors aussi du jeux principal, question d'avoir des données le plus complètes possible.\n\nEt pour simplifier notre jeu sur les continents, nous ne retiendrons que l'essentiel.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy_cons_continent <- data_energy_cons_continent %>%\n    dplyr::filter(iso_code == \"Africa\")\n```\n:::\n\n\n\n### Ajout d'une variable *continents*\n\nURL de la source des données pour réaliser la tâche :  \n[https://ourworldindata.org/grapher/continents-according-to-our-world-in-data?tab=table](https://ourworldindata.org/grapher/continents-according-to-our-world-in-data?tab=table)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhtml <- \"https://ourworldindata.org/grapher/continents-according-to-our-world-in-data?tab=table\"\n\ndata_continents <- read_html(x = html) %>%\n    html_element(css = \".data-table\") #%>% \n    #html_table()\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}