{
  "hash": "8b250266f24f352e53e891e25203687d",
  "result": {
    "markdown": "---\ntitle: \"Importation des données\"\ntitle-block-banner: false\n# description: | \n#  Petite description de cette page.\n# à changer\ndate: \"2022-12-20\"\n# Modifier les détails que vous voulez\nauthor:\n  - name: \"Amélie Levasseur-Raymond\"\n    # Votre site web perso ou github\n    url: https://amelie-lr.github.io/\n    # les champs d'affiliation sont optionnels, vous pouvez les\n    # comment out en ajoutant un # devant.\n    affiliation: FAS1002\n    affiliation-url: https://FAS1002.github.io/A22\n    # changer pour votre propre orcid id\n    # https://orcid.org/ pour vous inscrire.\n    # orcid: 0000-0000-0000-0000\n\n# TRUE == Générer une citation pour cette page précise. Pour enlever, mettre false.\ncitation: true\n# Inclure les références que vous utilisez dans vos rapports. Je conseille Zotero pour construire\n# ce fichier ou de connecter RStudio directement pour pouvoir citer avec @nom-de-reference.\nbibliography: references.bib\n---\n\n::: {.cell}\n\n:::\n\n\n## Téléchargement des données\n\n### Our World in Data - Energy\n\n> Les données proviennent de @owidenergy.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# chemin relatif vers le dossier qui contient les données brutes\nbase_path <- path(\"data\", \"raw\")\n\nurl_energy <- \"https://nyc3.digitaloceanspaces.com/owid-public/data/energy/owid-energy-data.csv\"\n\n# personnaliser le nom du fichier téléchargé en y ajoutant la date du jour\nfname_energy <- paste(today(), \"owid-energy-data.csv\", sep = \"_\")\n# établir le chemin relatif complet de notre fichier personnalisé téléchargé\nfpath_energy <- path(base_path, fname_energy)\n\n# télécharger les données seulement si elles n'ont pas déjà été téléchargées aujourd'hui\n# inspiré de : https://stackoverflow.com/questions/14904983/how-do-i-check-the-existence-of-a-downloaded-file\n# télécharge seulement si le fichier en date du jour n'existe pas en supprimant l'ancienne version\nif (!file.exists(fpath_energy)) {\n    file.remove(paste(base_path, dir(path = base_path, pattern = \"*_owid-energy-data.csv\"), sep = \"/\"))\n    download.file(url = url_energy, \n              destfile = fpath_energy)\n}\n```\n:::\n\n\nLe fichier a été téléchargé ici : **data/raw/2022-12-20_owid-energy-data.csv**\n\n### Gapminder - Life Expectancy at Birth\n\n> Les données proviennent de @gmlifeexpectancy\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# url prise de Download lastest version : Excel file\nurl_life <- \"https://docs.google.com/spreadsheets/d/1RheSon1-q4vFc3AGyupVPH6ptEByE-VtnjOCselU0PE/export?format=xlsx\"\n\n# pour ne pas avoir de demande d'authentification Google\ngs4_deauth()\n\n# date sans le jour (année-mois)\ntoday_month <- paste(year(today()), month(today()), sep = \"-\")\n# personnaliser le nom du fichier téléchargé en y ajoutant la date du jour\nfname_life <- paste(today_month, \"gm-life-expectancy-data.xlsx\", sep = \"_\")\n# établir le chemin relatif complet de notre fichier personnalisé téléchargé\nfpath_life <- path(base_path, fname_life)\n\nif (!file.exists(fpath_life)) {\n    file.remove(paste(base_path, dir(path = base_path, pattern = \"*_gm-life-expectancy-data.xlsx\"), sep = \"/\"))\n    download.file(url = url_life, \n              destfile = fpath_life)\n}\n```\n:::\n\n\nLe fichier a été téléchargé ici : **data/raw/2022-12_gm-life-expectancy-data.xlsx**\n\nNous constatons maintenant que notre dossier contient les fichiers suivants :  \ndata/raw/2022-12-20_owid-energy-data.csv, data/raw/2022-12_gm-life-expectancy-data.xlsx\n\n## Premier coup d'oeil\n\nVoyons d'abord plus en détails ce que nous avons comme données.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy <- as_tibble(read_csv(file = fpath_energy))\n\ndata_life <- as_tibble(read_excel(fpath_life, sheet = \"data-for-countries-etc-by-year\", range = NULL, trim_ws = TRUE, col_names = TRUE))\n```\n:::\n\n\n### Énergie\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(slice_sample(data_energy, n = 5))\n```\n\n::: {.cell-output-display}\n|country             | year|iso_code | population|          gdp| biofuel_cons_change_pct| biofuel_cons_change_twh| biofuel_cons_per_capita| biofuel_consumption| biofuel_elec_per_capita| biofuel_electricity| biofuel_share_elec| biofuel_share_energy| carbon_intensity_elec| coal_cons_change_pct| coal_cons_change_twh| coal_cons_per_capita| coal_consumption| coal_elec_per_capita| coal_electricity| coal_prod_change_pct| coal_prod_change_twh| coal_prod_per_capita| coal_production| coal_share_elec| coal_share_energy| electricity_demand| electricity_generation| electricity_share_energy| energy_cons_change_pct| energy_cons_change_twh| energy_per_capita| energy_per_gdp| fossil_cons_change_pct| fossil_cons_change_twh| fossil_elec_per_capita| fossil_electricity| fossil_energy_per_capita| fossil_fuel_consumption| fossil_share_elec| fossil_share_energy| gas_cons_change_pct| gas_cons_change_twh| gas_consumption| gas_elec_per_capita| gas_electricity| gas_energy_per_capita| gas_prod_change_pct| gas_prod_change_twh| gas_prod_per_capita| gas_production| gas_share_elec| gas_share_energy| greenhouse_gas_emissions| hydro_cons_change_pct| hydro_cons_change_twh| hydro_consumption| hydro_elec_per_capita| hydro_electricity| hydro_energy_per_capita| hydro_share_elec| hydro_share_energy| low_carbon_cons_change_pct| low_carbon_cons_change_twh| low_carbon_consumption| low_carbon_elec_per_capita| low_carbon_electricity| low_carbon_energy_per_capita| low_carbon_share_elec| low_carbon_share_energy| net_elec_imports| net_elec_imports_share_demand| nuclear_cons_change_pct| nuclear_cons_change_twh| nuclear_consumption| nuclear_elec_per_capita| nuclear_electricity| nuclear_energy_per_capita| nuclear_share_elec| nuclear_share_energy| oil_cons_change_pct| oil_cons_change_twh| oil_consumption| oil_elec_per_capita| oil_electricity| oil_energy_per_capita| oil_prod_change_pct| oil_prod_change_twh| oil_prod_per_capita| oil_production| oil_share_elec| oil_share_energy| other_renewable_consumption| other_renewable_electricity| other_renewable_exc_biofuel_electricity| other_renewables_cons_change_pct| other_renewables_cons_change_twh| other_renewables_elec_per_capita| other_renewables_elec_per_capita_exc_biofuel| other_renewables_energy_per_capita| other_renewables_share_elec| other_renewables_share_elec_exc_biofuel| other_renewables_share_energy| per_capita_electricity| primary_energy_consumption| renewables_cons_change_pct| renewables_cons_change_twh| renewables_consumption| renewables_elec_per_capita| renewables_electricity| renewables_energy_per_capita| renewables_share_elec| renewables_share_energy| solar_cons_change_pct| solar_cons_change_twh| solar_consumption| solar_elec_per_capita| solar_electricity| solar_energy_per_capita| solar_share_elec| solar_share_energy| wind_cons_change_pct| wind_cons_change_twh| wind_consumption| wind_elec_per_capita| wind_electricity| wind_energy_per_capita| wind_share_elec| wind_share_energy|\n|:-------------------|----:|:--------|----------:|------------:|-----------------------:|-----------------------:|-----------------------:|-------------------:|-----------------------:|-------------------:|------------------:|--------------------:|---------------------:|--------------------:|--------------------:|--------------------:|----------------:|--------------------:|----------------:|--------------------:|--------------------:|--------------------:|---------------:|---------------:|-----------------:|------------------:|----------------------:|------------------------:|----------------------:|----------------------:|-----------------:|--------------:|----------------------:|----------------------:|----------------------:|------------------:|------------------------:|-----------------------:|-----------------:|-------------------:|-------------------:|-------------------:|---------------:|-------------------:|---------------:|---------------------:|-------------------:|-------------------:|-------------------:|--------------:|--------------:|----------------:|------------------------:|---------------------:|---------------------:|-----------------:|---------------------:|-----------------:|-----------------------:|----------------:|------------------:|--------------------------:|--------------------------:|----------------------:|--------------------------:|----------------------:|----------------------------:|---------------------:|-----------------------:|----------------:|-----------------------------:|-----------------------:|-----------------------:|-------------------:|-----------------------:|-------------------:|-------------------------:|------------------:|--------------------:|-------------------:|-------------------:|---------------:|-------------------:|---------------:|---------------------:|-------------------:|-------------------:|-------------------:|--------------:|--------------:|----------------:|---------------------------:|---------------------------:|---------------------------------------:|--------------------------------:|--------------------------------:|--------------------------------:|--------------------------------------------:|----------------------------------:|---------------------------:|---------------------------------------:|-----------------------------:|----------------------:|--------------------------:|--------------------------:|--------------------------:|----------------------:|--------------------------:|----------------------:|----------------------------:|---------------------:|-----------------------:|---------------------:|---------------------:|-----------------:|---------------------:|-----------------:|-----------------------:|----------------:|------------------:|--------------------:|--------------------:|----------------:|--------------------:|----------------:|----------------------:|---------------:|-----------------:|\n|EU28 (Shift)        | 1946|NA       |         NA|           NA|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|               36.728|              873.920|                   NA|        3253.367|              NA|                NA|                 NA|                     NA|                       NA|                     NA|                     NA|                NA|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|              23.383|               4.621|                  NA|         24.382|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|               2.757|               2.082|                  NA|         77.595|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                         NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|Turkey              | 1992|TUR      |   56302040| 538702184448|                      NA|                      NA|                      NA|                  NA|                   0.888|                0.05|              0.074|                   NA|                    NA|               -0.362|               -0.721|             3526.262|          198.536|              435.331|            24.51|               10.117|               12.948|             2503.003|         140.924|          36.392|            32.908|              67.22|                  67.35|                   11.164|                  5.156|                 29.579|          10715.42|           1.12|                  3.575|                 18.098|                722.176|              40.66|                 9313.886|                 524.391|            60.371|               86.92|               9.414|               3.725|          43.289|                 192|           10.81|               768.863|              -2.463|              -0.053|               37.45|          2.109|         16.050|            7.175|                       NA|                17.126|                11.487|            78.561|               471.919|             26.57|                1395.354|           39.451|             13.022|                     17.023|                     11.482|                 78.909|                     474.05|                  26.69|                     1401.532|                39.629|                   13.08|            -0.13|                        -0.193|                      NA|                       0|                   0|                       0|                0.00|                         0|              0.000|                    0|               5.643|              15.094|         282.566|              94.846|            5.34|               5018.76|              -4.284|              -2.412|             957.205|         53.893|          7.929|           46.837|                       0.348|                        0.12|                                    0.07|                           -2.506|                           -0.005|                            2.131|                                        1.243|                              6.178|                       0.178|                                   0.104|                         0.058|               1196.227|                    603.300|                     17.023|                     11.482|                 78.909|                     474.05|                  26.69|                     1401.532|                39.629|                   13.08|                    NA|                     0|                 0|                     0|              0.00|                       0|            0.000|                  0|                   NA|                    0|                0|                    0|             0.00|                      0|           0.000|                 0|\n|OECD - Europe (EIA) | 1981|NA       |         NA|           NA|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|                   NA|                   NA|                   NA|              NA|              NA|                NA|                 NA|                     NA|                       NA|                 -3.617|               -731.658|                NA|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|                  NA|                  NA|             NA|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|                  NA|                  NA|             NA|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                  19499.332|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|Martinique          | 1989|MTQ      |     368415|           NA|                      NA|                      NA|                      NA|                  NA|                      NA|                  NA|                 NA|                   NA|                    NA|                   NA|                   NA|                   NA|               NA|                   NA|               NA|                   NA|                0.000|                0.000|           0.000|              NA|                NA|                 NA|                     NA|                       NA|                 38.131|                  1.615|          15882.36|             NA|                     NA|                     NA|                     NA|                 NA|                       NA|                      NA|                NA|                  NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|               0.000|                0.00|          0.000|             NA|               NA|                       NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|                  NA|                        NA|                 NA|                   NA|                  NA|                  NA|              NA|                  NA|              NA|                    NA|                  NA|               0.000|               0.000|          0.000|             NA|               NA|                          NA|                          NA|                                      NA|                               NA|                               NA|                               NA|                                           NA|                                 NA|                          NA|                                      NA|                            NA|                     NA|                      5.851|                         NA|                         NA|                     NA|                         NA|                     NA|                           NA|                    NA|                      NA|                    NA|                    NA|                NA|                    NA|                NA|                      NA|               NA|                 NA|                   NA|                   NA|               NA|                   NA|               NA|                     NA|              NA|                NA|\n|G7 (Ember)          | 2017|NA       |         NA|           NA|                      NA|                      NA|                      NA|                  NA|                      NA|              210.66|              2.796|                   NA|               377.121|                   NA|                   NA|                   NA|               NA|                   NA|          1897.33|                   NA|                   NA|                   NA|              NA|          25.181|                NA|            7534.67|                7534.67|                       NA|                     NA|                     NA|                NA|             NA|                     NA|                     NA|                     NA|            4235.06|                       NA|                      NA|            56.208|                  NA|                  NA|                  NA|              NA|                  NA|         2166.34|                    NA|                  NA|                  NA|                  NA|             NA|         28.752|               NA|                  2841.48|                    NA|                    NA|                NA|                    NA|            880.13|                      NA|           11.681|                 NA|                         NA|                         NA|                     NA|                         NA|                3299.61|                           NA|                43.792|                      NA|               NA|                            NA|                      NA|                      NA|                  NA|                      NA|             1473.29|                        NA|             19.553|                   NA|                  NA|                  NA|              NA|                  NA|          171.39|                    NA|                  NA|                  NA|                  NA|             NA|          2.275|               NA|                          NA|                      235.80|                                   25.14|                               NA|                               NA|                               NA|                                           NA|                                 NA|                       3.130|                                   0.334|                            NA|                     NA|                         NA|                         NA|                         NA|                     NA|                         NA|                1826.32|                           NA|                24.239|                      NA|                    NA|                    NA|                NA|                    NA|            220.72|                      NA|            2.929|                 NA|                   NA|                   NA|               NA|                   NA|           489.67|                     NA|           6.499|                NA|\n:::\n:::\n\n\nPremière question à se poser : Utiliserons-nous toutes ces variables?  \nSûrement pas, d'autant plus qu'il semble y avoir beaucoup d'informations manquantes. Nous y reviendrons...\n\n### Espérance de vie\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(slice_sample(data_life, n = 5))\n```\n\n::: {.cell-output-display}\n|geo |name         | time| Life expectancy|\n|:---|:------------|----:|---------------:|\n|kwt |Kuwait       | 2025|           82.15|\n|swz |Swaziland    | 2015|           54.88|\n|zaf |South Africa | 2066|           73.05|\n|gmb |Gambia       | 1911|           39.80|\n|mdg |Madagascar   | 1845|           30.50|\n:::\n:::\n\n\n\n\n## Nettoyage des données\n\nÀ première vue, les données semblent être bien arrangées et *tidy*. Rien de trop grave ne saute aux yeux. Uniformisons cependant les noms des colonnes entre les deux jeux de données en les nettoyant un peu par le fait même.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# renommer les titres de colonnes de data_life pour concorder avec ceux de data_energy\ndata_life_clean <- data_life %>%\n    dplyr::rename(life_expectancy = `Life expectancy`,\n                  year = `time`,\n                  country = `name`,\n                  iso_code = `geo`)\n```\n:::\n\n\nLes codes ISO des pays devraient aussi être uniformisés pour les avoir en majuscules dans les deux jeux.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# convertir les codes ISO du jeux data_life pour qu'ils soient en majuscules\n# inspiré de : https://stackoverflow.com/questions/16516593/convert-from-lowercase-to-uppercase-all-values-in-all-character-variables-in-dat\ndata_life_clean$iso_code <- toupper(data_life_clean$iso_code)\n```\n:::\n\n\nNous nous retrouvons maintenant avec les noms de colonnes suivants dans le jeu *Life Expectancy at Birth* : iso_code, country, year, life_expectancy\n\n## Manipulations\n\nNous ne conserverons que les variables qui nous intéressent du jeux Energy. Nous nous attarderons donc seulement à l'énergie **consommée**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy_cons <- data_energy %>%\n    select(iso_code,\n           country,\n           year,\n           population,\n           contains(\"cons\")\n           )\n\nkable(slice_sample(data_energy_cons, n = 5))\n```\n\n::: {.cell-output-display}\n|iso_code |country     | year| population| biofuel_cons_change_pct| biofuel_cons_change_twh| biofuel_cons_per_capita| biofuel_consumption| coal_cons_change_pct| coal_cons_change_twh| coal_cons_per_capita| coal_consumption| energy_cons_change_pct| energy_cons_change_twh| fossil_cons_change_pct| fossil_cons_change_twh| fossil_fuel_consumption| gas_cons_change_pct| gas_cons_change_twh| gas_consumption| hydro_cons_change_pct| hydro_cons_change_twh| hydro_consumption| low_carbon_cons_change_pct| low_carbon_cons_change_twh| low_carbon_consumption| nuclear_cons_change_pct| nuclear_cons_change_twh| nuclear_consumption| oil_cons_change_pct| oil_cons_change_twh| oil_consumption| other_renewable_consumption| other_renewables_cons_change_pct| other_renewables_cons_change_twh| primary_energy_consumption| renewables_cons_change_pct| renewables_cons_change_twh| renewables_consumption| solar_cons_change_pct| solar_cons_change_twh| solar_consumption| wind_cons_change_pct| wind_cons_change_twh| wind_consumption|\n|:--------|:-----------|----:|----------:|-----------------------:|-----------------------:|-----------------------:|-------------------:|--------------------:|--------------------:|--------------------:|----------------:|----------------------:|----------------------:|----------------------:|----------------------:|-----------------------:|-------------------:|-------------------:|---------------:|---------------------:|---------------------:|-----------------:|--------------------------:|--------------------------:|----------------------:|-----------------------:|-----------------------:|-------------------:|-------------------:|-------------------:|---------------:|---------------------------:|--------------------------------:|--------------------------------:|--------------------------:|--------------------------:|--------------------------:|----------------------:|---------------------:|---------------------:|-----------------:|--------------------:|--------------------:|----------------:|\n|COL      |Colombia    | 1968|   19872508|                      NA|                      NA|                      NA|                  NA|               -8.914|               -2.291|             1178.069|           23.411|                  5.396|                  5.567|                  4.528|                  4.084|                  94.275|               1.917|               0.221|          11.771|                11.432|                 1.484|            14.463|                     11.432|                      1.484|                 14.463|                      NA|                       0|                   0|              11.624|               6.153|          59.093|                           0|                               NA|                                0|                    108.738|                     11.432|                      1.484|                 14.463|                    NA|                     0|                 0|                   NA|                    0|                0|\n|SSD      |South Sudan | 2020|   10606224|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                     NA|                     NA|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                         NA|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|CMR      |Cameroon    | 1989|   11089225|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                 16.068|                  3.125|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                     22.573|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|SRB      |Serbia      | 2014|    7543965|                      NA|                      NA|                      NA|                  NA|                   NA|                   NA|                   NA|               NA|                -10.923|                -20.790|                     NA|                     NA|                      NA|                  NA|                  NA|              NA|                    NA|                    NA|                NA|                         NA|                         NA|                     NA|                      NA|                      NA|                  NA|                  NA|                  NA|              NA|                          NA|                               NA|                               NA|                    169.549|                         NA|                         NA|                     NA|                    NA|                    NA|                NA|                   NA|                   NA|               NA|\n|ISR      |Israel      | 1971|    3018592|                      NA|                      NA|                      NA|                  NA|                   NA|                0.000|                0.000|            0.000|                 13.479|                  8.566|                 13.479|                  8.566|                  72.115|              -6.396|              -0.082|           1.206|                    NA|                 0.000|             0.000|                         NA|                      0.000|                  0.000|                      NA|                       0|                   0|              13.890|               8.648|          70.909|                           0|                               NA|                                0|                     72.115|                         NA|                      0.000|                  0.000|                    NA|                     0|                 0|                   NA|                    0|                0|\n:::\n:::\n\n\nDéjà beaucoup mieux, nous sommes passé de 129 à 45 variables. \nMais il y encore encore beaucoup de bruit, réduisons encore un peu plus.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy_cons <- data_energy_cons %>%\n    select(iso_code,\n           country,\n           year,\n           population,\n           contains(\"consumption\")\n           )\n\nkable(slice_sample(data_energy_cons, n = 5))\n```\n\n::: {.cell-output-display}\n|iso_code |country        | year| population| biofuel_consumption| coal_consumption| fossil_fuel_consumption| gas_consumption| hydro_consumption| low_carbon_consumption| nuclear_consumption| oil_consumption| other_renewable_consumption| primary_energy_consumption| renewables_consumption| solar_consumption| wind_consumption|\n|:--------|:--------------|----:|----------:|-------------------:|----------------:|-----------------------:|---------------:|-----------------:|----------------------:|-------------------:|---------------:|---------------------------:|--------------------------:|----------------------:|-----------------:|----------------:|\n|HRV      |Croatia        | 1998|    4659937|                  NA|            2.705|                  80.897|          25.118|            17.807|                 17.823|               0.000|          53.075|                       0.016|                     98.720|                 17.823|             0.000|            0.000|\n|NA       |South America  | 2019|  428318218|                  NA|          345.465|                4340.131|        1398.971|          1763.960|               2289.526|              62.154|        2595.695|                     231.006|                   6924.609|               2227.373|            41.052|          191.354|\n|NA       |Other CIS (BP) | 2006|         NA|                  NA|            9.321|                  88.048|          52.125|            92.624|                 99.841|               7.209|          26.602|                       0.000|                    187.889|                 92.632|             0.000|            0.007|\n|MLT      |Malta          | 1991|     368676|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                      8.540|                     NA|                NA|               NA|\n|NA       |Europe (Shift) | 1990|         NA|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n:::\n:::\n\n\n\n\n### Ajout d'une variable *continents*\n\n> Pour ce faire, nous utiliserons le package de @countrycodepack\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy_cons_clean <- data_energy_cons %>%\n    mutate(countrycode(data_energy_cons$iso_code, origin = \"iso3c\", destination = \"continent\", custom_match = c( ATA = 'Antartica', ANT = 'Americas')), .before = 1) %>%\n    rename(continent = `countrycode(...)`)\n\nkable(slice_sample(data_energy_cons_clean, n = 10))\n```\n\n::: {.cell-output-display}\n|continent |iso_code |country              | year| population| biofuel_consumption| coal_consumption| fossil_fuel_consumption| gas_consumption| hydro_consumption| low_carbon_consumption| nuclear_consumption| oil_consumption| other_renewable_consumption| primary_energy_consumption| renewables_consumption| solar_consumption| wind_consumption|\n|:---------|:--------|:--------------------|----:|----------:|-------------------:|----------------:|-----------------------:|---------------:|-----------------:|----------------------:|-------------------:|---------------:|---------------------------:|--------------------------:|----------------------:|-----------------:|----------------:|\n|Africa    |ZWE      |Zimbabwe             | 1964|    4310332|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|Europe    |ROU      |Romania              | 1918|   12117371|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|Americas  |ANT      |Netherlands Antilles | 2004|     292853|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                     56.305|                     NA|                NA|               NA|\n|Asia      |HKG      |Hong Kong            | 2017|    7461508|                  NA|           72.968|                 359.084|          31.161|             0.000|                  0.225|               0.000|         254.955|                       0.208|                    359.495|                  0.225|             0.015|            0.003|\n|NA        |NA       |Europe (BP)          | 2010|         NA|              149.27|         4261.185|               19244.771|        6229.469|          1803.572|               5624.171|            2748.792|        8754.117|                     431.424|                  24868.943|               2875.379|            65.219|          425.895|\n|Americas  |LCA      |Saint Lucia          | 1998|     156872|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                      0.865|                     NA|                NA|               NA|\n|Africa    |BWA      |Botswana             | 1948|     395735|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|Asia      |BRN      |Brunei               | 1971|     138679|                  NA|               NA|                      NA|              NA|                NA|                     NA|                  NA|              NA|                          NA|                         NA|                     NA|                NA|               NA|\n|Asia      |VNM      |Vietnam              | 1990|   66912616|                  NA|           25.853|                  61.252|           0.386|            15.876|                 15.876|               0.000|          35.012|                       0.000|                     77.128|                 15.876|             0.000|            0.000|\n|Europe    |LUX      |Luxembourg           | 2000|     435634|                  NA|            1.276|                  36.694|           7.808|             0.365|                  0.510|               0.000|          27.611|                       0.071|                     37.204|                  0.510|             0.000|            0.073|\n:::\n:::\n\n\nUn message nous mentionne que deux codes ISO de pays n'ont pas trouvé d'équivalent, nous avons donc dû les ajouter manuellement dans la commande.\n\nAprès une analyse un peu plus poussée du jeu de données, nous constatons que la variable *country* correspond parfois à un pays et d'autres, à un continent ou région. Il serait donc préférable d'éliminer ces observations du jeu maintenant que nous avons ajouté la variable *continent*. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy_cons_clean <- data_energy_cons_clean %>%\n    filter(!is.na(continent))\n```\n:::\n\n\nLes pays sont donc maintenant associés aux continents suivants dans notre jeu de données :  \nAsia, Europe, Africa, Oceania, Antartica, Americas\n\n\n\n\n## Sauvegarde de nos jeux de données nettoyés\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_csv(data_energy_cons_clean, file = \"data/processed/owid-energy-consumption-data.csv\")\nwrite_csv(data_life_clean, file = \"data/processed/gm-life-expectancy-data.csv\")\n```\n:::\n\n\nNous voilà maintenant avec nos deux jeux de données nettoyés que nous pourrons réutiliser :  \ndata/processed/data_package.zip, data/processed/gm-life-expectancy-data.csv, data/processed/owid-energy-consumption-data.csv\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}