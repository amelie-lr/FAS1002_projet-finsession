{
  "hash": "cb9bf2d1353f50b3e769e97c6fd19121",
  "result": {
    "markdown": "---\ntitle: \"Exploration des jeux de données\"\ntitle-block-banner: false\n# description: | \n#  Petite description de cette page.\n# à changer\ndate: \"2022-12-20\"\n# Modifier les détails que vous voulez\nauthor:\n  - name: \"Amélie Levasseur-Raymond\"\n    # Votre site web perso ou github\n    url: https://amelie-lr.github.io/\n    # les champs d'affiliation sont optionnels, vous pouvez les\n    # comment out en ajoutant un # devant.\n    affiliation: FAS1002\n    affiliation-url: https://FAS1002.github.io/A22\n    # changer pour votre propre orcid id\n    # https://orcid.org/ pour vous inscrire.\n    # orcid: 0000-0000-0000-0000\n\n# TRUE == Générer une citation pour cette page précise. Pour enlever, mettre false.\ncitation: true\n# Inclure les références que vous utilisez dans vos rapports. Je conseille Zotero pour construire\n# ce fichier ou de connecter RStudio directement pour pouvoir citer avec @nom-de-reference.\nbibliography: references.bib\nformat: \n    html: \n        df-print: paged\n---\n\n::: {.cell}\n\n:::\n\n\n\n## Réimportation des données\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy_cons_clean <- as_tibble(read.csv(file = \"data/processed/owid-energy-consumption-data.csv\"))\n\ndata_life_clean <- as_tibble(read.csv(file = \"data/processed/gm-life-expectancy-data.csv\"))\n```\n:::\n\n\nVous pouvez télécharger les deux jeux de données nettoyés ci-dessous.\n\n- [Energy](data/processed/owid-energy-consumption-data.csv)\n- [Life Expectancy at Birth](data/processed/gm-life-expectancy-data.csv)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nzip(zipfile = \"data/processed/data_package.zip\", files = c(\"data/processed/owid-energy-consumption-data.csv\", \"data/processed/gm-life-expectancy-data.csv\"))\n```\n:::\n\n\nOu télécharger le .zip suivant contenant les deux fichiers : [ZIP](data/processed/data_package.zip)\n\n## Première exploration\n\nObservons à quoi ressemblent nos données.\n\nDans le jeu *Energy*, nous avons les 18 variables suivantes :  \ncontinent, iso_code, country, year, population, biofuel_consumption, coal_consumption, fossil_fuel_consumption, gas_consumption, hydro_consumption, low_carbon_consumption, nuclear_consumption, oil_consumption, other_renewable_consumption, primary_energy_consumption, renewables_consumption, solar_consumption, wind_consumption\n\nNous avons 219 pays dans le jeu *Energy* et 195 pays observés dans le jeu *Life Expectancy*. \n\n### Quelques statistiques\n\n#### Energy\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_energy_cons_clean %>%\n    skim() %>%\n    kable()\n```\n\n::: {.cell-output-display}\n|skim_type |skim_variable               | n_missing| complete_rate| character.min| character.max| character.empty| character.n_unique| character.whitespace| numeric.mean|   numeric.sd| numeric.p0|  numeric.p25|  numeric.p50|  numeric.p75| numeric.p100|numeric.hist |\n|:---------|:---------------------------|---------:|-------------:|-------------:|-------------:|---------------:|------------------:|--------------------:|------------:|------------:|----------:|------------:|------------:|------------:|------------:|:------------|\n|character |continent                   |         0|     1.0000000|             4|             9|               0|                  6|                    0|           NA|           NA|         NA|           NA|           NA|           NA|           NA|NA           |\n|character |iso_code                    |         0|     1.0000000|             3|             3|               0|                219|                    0|           NA|           NA|         NA|           NA|           NA|           NA|           NA|NA           |\n|character |country                     |         0|     1.0000000|             4|            32|               0|                219|                    0|           NA|           NA|         NA|           NA|           NA|           NA|           NA|NA           |\n|numeric   |year                        |         0|     1.0000000|            NA|            NA|              NA|                 NA|                   NA| 1.973103e+03| 3.527834e+01|   1900.000| 1.944000e+03|    1983.0000| 2.003000e+03| 2.021000e+03|▃▃▃▆▇        |\n|numeric   |population                  |       105|     0.9935948|            NA|            NA|              NA|                 NA|                   NA| 2.683007e+07| 1.009892e+08|   1833.000| 1.242297e+06| 5655064.0000| 1.707491e+07| 1.425894e+09|▇▁▁▁▁        |\n|numeric   |biofuel_consumption         |     15555|     0.0511194|            NA|            NA|              NA|                 NA|                   NA| 1.750296e+01| 5.325610e+01|      0.000| 0.000000e+00|       1.7265| 1.113350e+01| 4.158700e+02|▇▁▁▁▁        |\n|numeric   |coal_consumption            |     12197|     0.2559629|            NA|            NA|              NA|                 NA|                   NA| 3.635408e+02| 1.591186e+03|      0.000| 3.122250e+00|      30.6280| 1.464560e+02| 2.393606e+04|▇▁▁▁▁        |\n|numeric   |fossil_fuel_consumption     |     12200|     0.2557799|            NA|            NA|              NA|                 NA|                   NA| 1.126322e+03| 3.167427e+03|      0.097| 1.151510e+02|     275.7240| 8.837950e+02| 3.622259e+04|▇▁▁▁▁        |\n|numeric   |gas_consumption             |     12174|     0.2573659|            NA|            NA|              NA|                 NA|                   NA| 2.714109e+02| 8.072350e+02|      0.000| 8.603500e+00|      51.4900| 2.129660e+02| 8.506917e+03|▇▁▁▁▁        |\n|numeric   |hydro_consumption           |     12178|     0.2571219|            NA|            NA|              NA|                 NA|                   NA| 8.460001e+01| 2.342560e+02|      0.000| 1.160000e+00|      12.7240| 5.990150e+01| 3.471190e+03|▇▁▁▁▁        |\n|numeric   |low_carbon_consumption      |     12178|     0.2571219|            NA|            NA|              NA|                 NA|                   NA| 1.710000e+02| 4.878965e+02|      0.000| 3.125000e+00|      29.0250| 1.186910e+02| 7.568308e+03|▇▁▁▁▁        |\n|numeric   |nuclear_consumption         |     12335|     0.2475447|            NA|            NA|              NA|                 NA|                   NA| 6.572366e+01| 2.386440e+02|      0.000| 0.000000e+00|       0.0000| 2.269325e+01| 2.303296e+03|▇▁▁▁▁        |\n|numeric   |oil_consumption             |     12171|     0.2575490|            NA|            NA|              NA|                 NA|                   NA| 4.876528e+02| 1.230013e+03|      0.097| 6.367900e+01|     140.1235| 3.838988e+02| 1.121408e+04|▇▁▁▁▁        |\n|numeric   |other_renewable_consumption |     12221|     0.2544989|            NA|            NA|              NA|                 NA|                   NA| 8.552775e+00| 2.970564e+01|      0.000| 0.000000e+00|       0.1210| 3.729000e+00| 5.423670e+02|▇▁▁▁▁        |\n|numeric   |primary_energy_consumption  |      6837|     0.5829317|            NA|            NA|              NA|                 NA|                   NA| 5.850661e+02| 2.465123e+03|      0.000| 5.145500e+00|      46.4135| 2.914692e+02| 4.379089e+04|▇▁▁▁▁        |\n|numeric   |renewables_consumption      |     12178|     0.2571219|            NA|            NA|              NA|                 NA|                   NA| 1.077307e+02| 3.234790e+02|      0.000| 2.440000e+00|      17.1260| 7.868350e+01| 6.545095e+03|▇▁▁▁▁        |\n|numeric   |solar_consumption           |     12221|     0.2544989|            NA|            NA|              NA|                 NA|                   NA| 3.008373e+00| 2.653056e+01|      0.000| 0.000000e+00|       0.0000| 1.500000e-02| 8.556530e+02|▇▁▁▁▁        |\n|numeric   |wind_consumption            |     12221|     0.2544989|            NA|            NA|              NA|                 NA|                   NA| 8.297709e+00| 5.954927e+01|      0.000| 0.000000e+00|       0.0000| 1.780000e-01| 1.715493e+03|▇▁▁▁▁        |\n:::\n:::\n\n\n#### Life Expectancy at Birth\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_life_clean %>%\n    skim() %>%\n    kable()\n```\n\n::: {.cell-output-display}\n|skim_type |skim_variable   | n_missing| complete_rate| character.min| character.max| character.empty| character.n_unique| character.whitespace| numeric.mean| numeric.sd| numeric.p0| numeric.p25| numeric.p50| numeric.p75| numeric.p100|numeric.hist |\n|:---------|:---------------|---------:|-------------:|-------------:|-------------:|---------------:|------------------:|--------------------:|------------:|----------:|----------:|-----------:|-----------:|-----------:|------------:|:------------|\n|character |iso_code        |         0|             1|             3|             3|               0|                195|                    0|           NA|         NA|         NA|          NA|          NA|          NA|           NA|NA           |\n|character |country         |         0|             1|             3|            30|               0|                195|                    0|           NA|         NA|         NA|          NA|          NA|          NA|           NA|NA           |\n|numeric   |year            |         0|             1|            NA|            NA|              NA|                 NA|                   NA|   1950.38390|   86.50872|    1800.00|      1876.0|    1952.000|     2024.00|      2100.00|▇▇▇▇▇        |\n|numeric   |life_expectancy |         0|             1|            NA|            NA|              NA|                 NA|                   NA|     53.35266|   21.32014|       1.01|        32.9|      50.015|       73.96|        94.42|▁▇▃▅▅        |\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n\n\n## Life Expectancy at Birth\n\n#### Tâche : calculer le temps écoulé **en jours** entre la première année que des données ont été récoltées pour chacun des pays et la production de ce rapport\n\nIdentifions d'abord la première année pour chaque pays.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# source : https://stackoverflow.com/questions/60460203/finding-year-of-first-occurrence-in-r\nlife_country <- data_life_clean %>%\n    # ne conserver que les variables utiles à la tâche\n    select(country, year) %>%\n    # grouper les observation par pays et ordonner selon l'année\n    group_by(country) %>%\n    arrange(country, year) %>%\n    # ne conserver que la première année pour chaque pays\n    slice_min(order_by = year, n = 1)\n\nfirst_year <- unique(life_country$year)\n```\n:::\n\n\nNous nous retrouvons donc avec les années suivantes : 1800, 1950\n\nPuisque nous n'avons pas la date exacte dans le jeu de données, mais seulement l'année, nous établirons cette date au 1er juillet, soit au milieu de l'année, pour calculer le nombre de jours écoulés.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# préciser une date exacte\nfirst_year <- as.Date(paste0(first_year, \"-07-01\"))\n\n# calculer le nombre de jours écoulés\n# source code : https://bookdown.org/Tazinho/Tidyverse-Cookbook/dates-and-times.html\n# source timezone : https://rdrr.io/r/base/timezones.html\ndays_passed <- difftime(lubridate::ymd(first_year, tz = Sys.timezone()), \n                        lubridate::ymd(today(), tz = Sys.timezone()), \n                        units = \"days\") %>%\n    as.double() %>%\n    round() %>%\n    abs()\n\ncountries_1800 <- paste(life_country$country[life_country$year == \"1800\"], collapse = \", \")\ncountries_1950 <- paste(life_country$country[life_country$year == \"1950\"], collapse = \", \")\n\n\ntibble(c(countries_1800, countries_1950), lubridate::year(first_year), days_passed) %>%\n    rename(first_year = `lubridate::year(first_year)`,\n           countries = `c(countries_1800, countries_1950)`) %>%\n    kable()\n```\n\n::: {.cell-output-display}\n|countries                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | first_year| days_passed|\n|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------:|-----------:|\n|Afghanistan, Albania, Algeria, Angola, Antigua and Barbuda, Argentina, Armenia, Australia, Austria, Azerbaijan, Bahamas, Bahrain, Bangladesh, Barbados, Belarus, Belgium, Belize, Benin, Bhutan, Bolivia, Bosnia and Herzegovina, Botswana, Brazil, Brunei, Bulgaria, Burkina Faso, Burundi, Cambodia, Cameroon, Canada, Cape Verde, Central African Republic, Chad, Chile, China, Colombia, Comoros, Congo, Dem. Rep., Congo, Rep., Costa Rica, Cote d'Ivoire, Croatia, Cuba, Cyprus, Czech Republic, Denmark, Djibouti, Dominican Republic, Ecuador, Egypt, El Salvador, Equatorial Guinea, Eritrea, Estonia, Ethiopia, Fiji, Finland, France, Gabon, Gambia, Georgia, Germany, Ghana, Greece, Grenada, Guatemala, Guinea, Guinea-Bissau, Guyana, Haiti, Honduras, Hong Kong, China, Hungary, Iceland, India, Indonesia, Iran, Iraq, Ireland, Israel, Italy, Jamaica, Japan, Jordan, Kazakhstan, Kenya, Kiribati, Kuwait, Kyrgyz Republic, Lao, Latvia, Lebanon, Lesotho, Liberia, Libya, Lithuania, Luxembourg, Macedonia, FYR, Madagascar, Malawi, Malaysia, Maldives, Mali, Malta, Mauritania, Mauritius, Mexico, Micronesia, Fed. Sts., Moldova, Mongolia, Montenegro, Morocco, Mozambique, Myanmar, Namibia, Nepal, Netherlands, New Zealand, Nicaragua, Niger, Nigeria, North Korea, Norway, Oman, Pakistan, Palestine, Panama, Papua New Guinea, Paraguay, Peru, Philippines, Poland, Portugal, Qatar, Romania, Russia, Rwanda, Samoa, Sao Tome and Principe, Saudi Arabia, Senegal, Serbia, Seychelles, Sierra Leone, Singapore, Slovak Republic, Slovenia, Solomon Islands, Somalia, South Africa, South Korea, South Sudan, Spain, Sri Lanka, St. Lucia, St. Vincent and the Grenadines, Sudan, Suriname, Swaziland, Sweden, Switzerland, Syria, Taiwan, Tajikistan, Tanzania, Thailand, Timor-Leste, Togo, Tonga, Trinidad and Tobago, Tunisia, Turkey, Turkmenistan, Uganda, Ukraine, United Arab Emirates, United Kingdom, United States, Uruguay, Uzbekistan, Vanuatu, Venezuela, Vietnam, Yemen, Zambia, Zimbabwe |       1800|       81256|\n|Andorra, Dominica, Marshall Islands, Monaco, Nauru, Palau, San Marino, St. Kitts and Nevis, Tuvalu                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |       1950|       26470|\n:::\n:::\n\n\n## Combinaison des deux jeux\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_merged <- merge(data_energy_cons_clean,\n                  data_life_clean,\n                  by = c(\"country\", \"year\", \"iso_code\")) %>%\n    tibble()\n```\n:::\n\n\nAfin de simplifier l'analyse, nous allons mettre les différentes consommations par habitant et les convertir en kW/h.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# convertir les consommations par habitant et en kilowatt/heure\ndata_merged_per_capita <- data_merged %>%\n    mutate(across(.cols = contains(\"consumption\"), .fns = ~ .x / population * 1000000000, .names = \"{.col}_per_capita\", .keep = \"all\")) %>%\n    select(!biofuel_consumption:wind_consumption)\n\nkable(slice_sample(data_merged_per_capita, n = 5))\n```\n\n::: {.cell-output-display}\n|country     | year|iso_code |continent | population| life_expectancy| biofuel_consumption_per_capita| coal_consumption_per_capita| fossil_fuel_consumption_per_capita| gas_consumption_per_capita| hydro_consumption_per_capita| low_carbon_consumption_per_capita| nuclear_consumption_per_capita| oil_consumption_per_capita| other_renewable_consumption_per_capita| primary_energy_consumption_per_capita| renewables_consumption_per_capita| solar_consumption_per_capita| wind_consumption_per_capita|\n|:-----------|----:|:--------|:---------|----------:|---------------:|------------------------------:|---------------------------:|----------------------------------:|--------------------------:|----------------------------:|---------------------------------:|------------------------------:|--------------------------:|--------------------------------------:|-------------------------------------:|---------------------------------:|----------------------------:|---------------------------:|\n|Angola      | 2006|AGO      |Africa    |   20162338|           56.96|                             NA|                          NA|                                 NA|                         NA|                           NA|                                NA|                             NA|                         NA|                                     NA|                              2453.237|                                NA|                           NA|                          NA|\n|Netherlands | 1983|NLD      |Europe    |   14369651|           76.33|                             NA|                    4272.129|                           52690.63|                   23815.61|                            0|                          760.0045|                       708.7159|                   24602.82|                               51.28865|                             53450.637|                          51.28865|                            0|                           0|\n|Bulgaria    | 1945|BGR      |Europe    |    6953599|           51.72|                             NA|                          NA|                                 NA|                         NA|                           NA|                                NA|                             NA|                         NA|                                     NA|                                    NA|                                NA|                           NA|                          NA|\n|Costa Rica  | 2017|CRI      |Americas  |    4993849|           79.83|                             NA|                          NA|                                 NA|                         NA|                           NA|                                NA|                             NA|                         NA|                                     NA|                             12726.857|                                NA|                           NA|                          NA|\n|Cambodia    | 1992|KHM      |Asia      |    9718217|           58.60|                             NA|                          NA|                                 NA|                         NA|                           NA|                                NA|                             NA|                         NA|                                     NA|                               224.321|                                NA|                           NA|                          NA|\n:::\n:::\n\n\n\n## Visualisation\n\n#### Espérance de vie selon l'année\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_merged_per_capita %>%\n    group_by(year) %>%\n    ggplot() +\n    geom_line(mapping = aes(x = year, y = life_expectancy, color = continent, group = country), \n                na.rm = TRUE) +\n    my_theme()\n```\n\n::: {.cell-output-display}\n![](exploration_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nOn constate rapidement une baisse de l'espérance de vie lors des deux gueres mondiales. \nLes autres points qui se trouvent sous la masse principale indiquent probablement des événements précis qui ont fait plusieurs morts dans des pays en particulier.\n\n\n#### Évolution de la population du Canada\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_merged_per_capita %>%\n    filter(country == \"Canada\") %>%\n    ggplot() +\n      geom_line(mapping = aes(x = year, y = population, colour = country), \n                na.rm = TRUE) +\n    my_theme()\n```\n\n::: {.cell-output-display}\n![](exploration_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n#### Consommation d'énergie fossile vs renouvelable (par habitant)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_merged_per_capita %>%\n    ggplot() +\n      geom_point(mapping = aes(x = fossil_fuel_consumption_per_capita, y = renewables_consumption_per_capita, color = continent), \n                 na.rm = TRUE) +\n    my_theme()\n```\n\n::: {.cell-output-display}\n![](exploration_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\nOn peut constater que l'Asie est une grande consommatrice d'énergie fossile, tandis que l'Europe a une tendance vers le renouvelable. Il faut tout de même pas se leurer puisque les deux axes ne sont pas gradués de la même façon. La consommation d'énergie renouvelable est bien en-deça de celle des énergies fossiles.\n\n\n#### Consommation d'énergie par habitant vs espérance de vie en 2020\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_merged_per_capita %>%\n    filter(year == 2020) %>%\n    ggplot() +\n      geom_point(mapping = aes(x = life_expectancy, y = primary_energy_consumption_per_capita, color = continent), \n                 na.rm = TRUE) +\n    my_theme()\n```\n\n::: {.cell-output-display}\n![](exploration_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\nOn peut observer une légère tendance à consommer plus par année là où l'on vie plus longtemps.\n\n\n#### Évolution de la consommation d'énergie primaire par habitant\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_merged_per_capita %>%\n    ggplot() +\n      geom_line(mapping = aes(x = year, y = primary_energy_consumption_per_capita, color = continent, group = country), \n                 na.rm = TRUE) +\n    xlim(1960,2025) +\n    my_theme()\n```\n\n::: {.cell-output-display}\n![](exploration_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "exploration_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}